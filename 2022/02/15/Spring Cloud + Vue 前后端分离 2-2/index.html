<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Fang">
    
    <title>
        
            Spring Cloud + Vue 前后端分离2-2 |
        
        念~旭
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/favicon.ico">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":false},"style":{"primary_color":"#0066CC","avatar":"/images/favicon.ico","favicon":"/images/favicon.ico","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"你舍得放弃么？你愿意放弃么？你能......放弃么？"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.4"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                念~旭
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Spring Cloud + Vue 前后端分离2-2</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/favicon.ico">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Fang</span>
                        
                            <span class="author-label">Lv5</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-02-15 08:36:23</span>
        <span class="mobile">2022-02-15 08:36</span>
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE/">完整项目</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>11.8k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>62 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="第7章-核心业务功能开发"><a href="#第7章-核心业务功能开发" class="headerlink" title="第7章 核心业务功能开发"></a>第7章 核心业务功能开发</h1><h2 id="7-1-课程管理功能开发-课程大章小节关联"><a href="#7-1-课程管理功能开发-课程大章小节关联" class="headerlink" title="7-1 课程管理功能开发-课程大章小节关联"></a>7-1 课程管理功能开发-课程大章小节关联</h2><p>本章将演示核心业务功能开发，包括课程、章、节、分类的管理功能，学习前端页面跳转及参数传递，Vue过滤器，前端树形展示插件zTree，富文本框的使用，Spring事务，通用排序功能解决方案等。</p>
<hr>
<p>课程管理页面美化：1.课程管理页面美化</p>
<ul>
<li><p>scoped：style下的样式只应用于当前组件，防止互相污染</p>
</li>
<li><p>只是修改前端，然后将table标签注释</p>
</li>
<li><pre><code class="vue">&lt;div class=&quot;row&quot;&gt;
  &lt;div v-for=&quot;course in courses&quot; class=&quot;col-md-4&quot;&gt;
    &lt;div class=&quot;thumbnail search-thumbnail&quot;&gt;
      &lt;img v-show=&quot;!course.image&quot; class=&quot;media-object&quot; src=&quot;/static/image/demo-course.jpg&quot; /&gt;
      &lt;img v-show=&quot;course.image&quot; class=&quot;media-object&quot; v-bind:src=&quot;course.image&quot; /&gt;
      &lt;div class=&quot;caption&quot;&gt;
        &lt;div class=&quot;clearfix&quot;&gt;
          &lt;span class=&quot;pull-right label label-primary info-label&quot;&gt;&#123;&#123;COURSE_LEVEL|option..KV(course.level)&#125;&#125;&lt;/span&gt;
          &lt;span class=&quot;pull-right label label-primary info-label&quot;&gt;&#123;&#123;COURSE_CHARGE|option..KV(course.charge)&#125;&#125;&lt;/span&gt;
          &lt;span class=&quot;pull-right label label-primary info-label&quot;&gt;&#123;&#123;COURSE_STATUS|option..KV(course.status)&#125;&#125;&lt;/span&gt;
        &lt;/div&gt;

        &lt;h3 class=&quot;search-title&quot;&gt;
          &lt;a href=&quot;#&quot; class=&quot;blue&quot;&gt;&#123;&#123; course.name&#125;&#125;&lt;/a&gt;
        &lt;/h3&gt;
        &lt;p&gt;
          &lt;span class=&quot;blue bolder bigger-150&quot;&gt;&#123;&#123;course.price&#125;&#125;&amp;nbsp;&lt;i class=&quot;fa fa-rmb&quot;&gt;&lt;/i&gt;&lt;/span&gt;&amp;nbsp;
        &lt;/p&gt;
        &lt;p&gt;&#123;&#123; course.summary&#125;&#125;&lt;/p&gt;
        &lt;p&gt;
          &lt;span class=&quot;badge badge-info&quot;&gt;&#123;&#123;course.id&#125;&#125;&lt;/span&gt;
          &lt;span class=&quot;badge badge-info&quot;&gt;排序：&#123;&#123;course.sort&#125;&#125;&lt;/span&gt;
          &lt;span class=&quot;badge badge-info&quot;&gt;时长：&#123;&#123;course.time&#125;&#125;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p&gt;
          &lt;button v-on:click=&quot;edit(course)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;
            编辑
          &lt;/button&gt;&amp;nbsp;
          &lt;button v-on:click=&quot;del(course.id)&quot; class=&quot;btn btn-white btn-xs btn-warning btn-round&quot;&gt;
            删除
          &lt;/button&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;
&lt;style scoped&gt;
  .caption h3&#123;
    font-size: 20px;
  &#125;
&lt;/style&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">课程管理和大章管理互相跳转</span><br><span class="line"></span><br><span class="line">- 完成功能：在课程列表中增加“大章”按钮，点击会跳转到大章页面，并且筛选出当前课程下所有的大章。大章页面增加显示课程名称，并且有可以返回课程管理页面。</span><br><span class="line"></span><br><span class="line">- sessionStorage是会话缓存，浏览器窗口关闭，缓存就没了。localStorage是本地缓存，浏览器关闭后，下次再打开还能读到。sessionStorage和localStorage只能操作字符串，但是我们经常要放对象数据，所以封装一下。</span><br><span class="line"></span><br><span class="line">- ```js</span><br><span class="line">  SessionStorage = &#123;</span><br><span class="line">      get: function (key) &#123;</span><br><span class="line">          let v = sessionStorage.getItem(key);</span><br><span class="line">          if (v &amp;&amp; typeof(v) !== &quot;undefined&quot; &amp;&amp; v !== &quot;undefined&quot;) &#123;</span><br><span class="line">              return JSON.parse(v);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      set: function (key, data) &#123;</span><br><span class="line">          sessionStorage.setItem(key, JSON.stringify(data));</span><br><span class="line">      &#125;,</span><br><span class="line">      remove: function (key) &#123;</span><br><span class="line">          sessionStorage.removeItem(key);</span><br><span class="line">      &#125;,</span><br><span class="line">      clearAll: function () &#123;</span><br><span class="line">          sessionStorage.clear();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><pre><code class="js">LocalStorage = &#123;
    get: function (key) &#123;
        let v = localStorage.getItem(key);
        if (v &amp;&amp; typeof(v) !== &quot;undefined&quot; &amp;&amp; v !== &quot;undefined&quot;) &#123;
            return JSON.parse(v);
        &#125;
    &#125;,
    set: function (key, data) &#123;
        localStorage.setItem(key, JSON.stringify(data));
    &#125;,
    remove: function (key) &#123;
        localStorage.removeItem(key);
    &#125;,
    clearAll: function () &#123;
        localStorage.clear();
    &#125;
&#125;;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 首先再index.html增加引用</span><br><span class="line"></span><br><span class="line">- ```html</span><br><span class="line">  &lt;!--  h5缓存  --&gt;</span><br><span class="line">  &lt;script src=&quot;&lt;%= BASE_URL %&gt;static/js/session-storage.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script src=&quot;&lt;%= BASE_URL %&gt;static/js/local-storage.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>然后再course.vue增加一个大章按钮进行跳转</p>
</li>
<li><pre><code class="vue">&lt;button v-on:click=&quot;toChapter(course)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;
        大章
&lt;/button&gt;&amp;nbsp;
//增加toChapter方法
toChapter(course) &#123;
      let _this = this;
      SessionStorage.set(&quot;course&quot;,course);
      _this.$router.push(&quot;/business/chapter&quot;);
   &#125;,
    
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 组件（页面）间传输数据可以用h5原生的localStorage或sessionStorage；也可以用js全局变量，也可以用vuex store。但是后两者会在页面刷新时丢失数据，所以推荐使用h5原生的。</span><br><span class="line"></span><br><span class="line">- 接下来再chapter.vue的mounted里将SessionStorage的缓存取出来</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">   data: function () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        chapter: &#123;&#125;,</span><br><span class="line">        chapters: [],</span><br><span class="line">        course:&#123;&#125;,//一定要加</span><br><span class="line">      &#125;</span><br><span class="line">  mounted: function () &#123;</span><br><span class="line">    let _this = this;</span><br><span class="line">    _this.$refs.pagination.size = 5;</span><br><span class="line">    let course = SessionStorage.get(&quot;course&quot;)||&#123;&#125;;</span><br><span class="line">    if (Tool.isEmpty(course))&#123;</span><br><span class="line">      _this.$router.push(&quot;/welcome&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    _this.course =course;</span><br><span class="line">    _this.list(1);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>简单的跳转可以用router-link，如过有其他操作，可以写个click方法。比如前面完成的，从课程跳到大章，需要先缓存课程信息，所以写click方法</p>
</li>
<li><pre><code class="vue">&lt;h3&gt;&#123;&#123;course.name&#125;&#125;&lt;/h3&gt;
/////////////////////////////////////////////////////////
  &lt;router-link to=&quot;/business/course&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;
    &lt;i class=&quot;ace-icon fa fa-arrow-left red2&quot;&gt;&lt;/i&gt;
    返回课程
  &lt;/router-link&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">大章管理保存和查询功能关联courseId</span><br><span class="line"></span><br><span class="line">- 改下chapter，将表单的courseID改成这个</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                  &lt;label  class=&quot;col-sm-2 control-label&quot;&gt;课程&lt;/label&gt;</span><br><span class="line">                  &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">                    &lt;P class=&quot;form-control-static&quot;&gt;&#123;&#123;course.name&#125;&#125;&lt;/P&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">  //////////////////////////</span><br><span class="line">  // save的保存校验</span><br><span class="line">        if (!Validator.require(_this.chapter.name, &quot;名称&quot;)</span><br><span class="line">            || !Validator.length(_this.chapter.courseId, &quot;课程ID&quot;, 1, 8)) &#123;</span><br><span class="line">          return;</span><br><span class="line">        &#125;</span><br><span class="line">        _this.chapter.courseId =_this.course.id;</span><br><span class="line">  ////////////////////////////////////////////////</span><br><span class="line">  list(page) &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        Loading.show();</span><br><span class="line">        _this.$ajax.post(process.env.VUE_APP_SERVER +&#x27;/business/admin/chapter/list&#x27;, &#123;</span><br><span class="line">          page: page,</span><br><span class="line">          size: _this.$refs.pagination.size,</span><br><span class="line">          courseId:_this.course.id//根据传进来的课程ID来筛选所有的章</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>首先再server的dto增加ChapterPageDto</p>
</li>
<li><pre><code class="java">package com.course.server.dto;

public class ChapterPageDto extends PageDto&#123;
    private String courseId;

    public String getCourseId() &#123;
        return courseId;
    &#125;

    public void setCourseId(String courseId) &#123;
        this.courseId = courseId;
    &#125;

    @Override
    public String toString() &#123;
        final StringBuffer sb = new StringBuffer(&quot;ChapterPageDto&#123;&quot;);
        sb.append(&quot;courseId=&#39;&quot;).append(courseId).append(&#39;\&#39;&#39;);
        sb.append(&quot;, page=&quot;).append(page);
        sb.append(&quot;, size=&quot;).append(size);
        sb.append(&quot;, total=&quot;).append(total);
        sb.append(&quot;, list=&quot;).append(list);
        sb.append(&#39;&#125;&#39;);
        return sb.toString();
    &#125;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 接着转到chaptercontroller</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  /**</span><br><span class="line">   * 列表查询</span><br><span class="line">   */</span><br><span class="line">  @PostMapping(&quot;/list&quot;)</span><br><span class="line">  public ResponseDto list(@RequestBody ChapterPageDto chapterPageDto)&#123;</span><br><span class="line">      ResponseDto responseDto = new ResponseDto();</span><br><span class="line">      ValidatorUtil.require(chapterPageDto.getCourseId(), &quot;课程ID&quot;);</span><br><span class="line">      chapterService.list(chapterPageDto);</span><br><span class="line">      responseDto.setContent(chapterPageDto);</span><br><span class="line">      return responseDto;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>然后ChapterService</p>
</li>
<li><pre><code class="java">/**
 * 列表查询
 */
public void list(ChapterPageDto chapterPageDto) &#123;
    PageHelper.startPage(chapterPageDto.getPage(), chapterPageDto.getSize());
    ChapterExample chapterExample = new ChapterExample();
    ChapterExample.Criteria criteria = chapterExample.createCriteria();
    if (!StringUtils.isEmpty(chapterPageDto.getCourseId())) &#123;
        criteria.andCourseIdEqualTo(chapterPageDto.getCourseId());
    &#125;
    List&lt;Chapter&gt; chapterList = chapterMapper.selectByExample(chapterExample);
    PageInfo&lt;Chapter&gt; pageInfo = new PageInfo&lt;&gt;(chapterList);
    chapterPageDto.setTotal(pageInfo.getTotal());
    List&lt;ChapterDto&gt; chapterDtoList = CopyUtil.copyList(chapterList, ChapterDto.class);
    chapterPageDto.setList(chapterDtoList);
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 经验分享：service层的查询条件写的松一点，灵活一点。service层可能被多个controller调用，也可能被其他service调用，每个调用的查询条件可能不一样</span><br><span class="line"></span><br><span class="line">大章管理和小节管理互相跳转：小节管理保存和查询功能关联courseId，chapterId</span><br><span class="line"></span><br><span class="line">- 对chapter做修改</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  &lt;h4 class=&quot;lighter&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;ace-icon fa fa-hand-o-right icon-animated-hand-pointer blue&quot;&gt;&lt;/i&gt;</span><br><span class="line">    &lt;router-link to=&quot;/business/course&quot; class=&quot;pink&quot;&gt; &#123;&#123;course.name&#125;&#125; &lt;/router-link&gt;</span><br><span class="line">  &lt;/h4&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  ////////////////////////////////////////</span><br><span class="line">  &lt;div class=&quot;hidden-sm hidden-xs btn-group&quot;&gt;</span><br><span class="line">      &lt;button v-on:click=&quot;toSection(chapter)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">          小节</span><br><span class="line">      &lt;/button&gt;&amp;nbsp;</span><br><span class="line">      &lt;button v-on:click=&quot;edit(chapter)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">          编辑</span><br><span class="line">      &lt;/button&gt;&amp;nbsp;</span><br><span class="line">      &lt;button v-on:click=&quot;del(chapter.id)&quot; class=&quot;btn btn-white btn-xs btn-warning btn-round&quot;&gt;</span><br><span class="line">          删除</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  /////////////////////////////////////////////</span><br><span class="line">  toSection(chapter) &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        SessionStorage.set(&quot;chapter&quot;, chapter);</span><br><span class="line">        _this.$router.push(&quot;/business/section&quot;);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>然后对section</p>
</li>
<li><pre><code class="vue">&lt;h4 class=&quot;lighter&quot;&gt;
  &lt;i class=&quot;ace-icon fa fa-hand-o-right icon-animated-hand-pointer blue&quot;&gt;&lt;/i&gt;
  &lt;router-link to=&quot;/business/course&quot; class=&quot;pink&quot;&gt; &#123;&#123;course.name&#125;&#125; &lt;/router-link&gt;：
  &lt;i class=&quot;ace-icon fa fa-hand-o-right icon-animated-hand-pointer blue&quot;&gt;&lt;/i&gt;
  &lt;router-link to=&quot;/business/chapter&quot; class=&quot;pink&quot;&gt; &#123;&#123;chapter.name&#125;&#125; &lt;/router-link&gt;
&lt;/h4&gt;
&lt;hr&gt;
///////////////////////////////////表单
&lt;div class=&quot;form-group&quot;&gt;
    &lt;label  class=&quot;col-sm-2 control-label&quot;&gt;课程&lt;/label&gt;
    &lt;div class=&quot;col-sm-10&quot;&gt;
        &lt;p class=&quot;form-control-static&quot;&gt;&#123;&#123;course.name&#125;&#125;&lt;/p&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;form-group&quot;&gt;
    &lt;label  class=&quot;col-sm-2 control-label&quot;&gt;大章&lt;/label&gt;
    &lt;div class=&quot;col-sm-10&quot;&gt;
        &lt;p class=&quot;form-control-static&quot;&gt;&#123;&#123;chapter.name&#125;&#125;&lt;/p&gt;
    &lt;/div&gt;
&lt;/div&gt;
////////////////////////////////////////////
 data: function () &#123;
    return &#123;
      section: &#123;&#125;,
      sections: [],
      SECTION_CHARGE: SECTION_CHARGE,
      course:&#123;&#125;,//这
      chapter:&#123;&#125;,//这
    &#125;
  &#125;,
  mounted: function () &#123;
    let _this = this;
    _this.$refs.pagination.size = 5;
    let course = SessionStorage.get(&quot;course&quot;) || &#123;&#125;;
    let chapter = SessionStorage.get(&quot;chapter&quot;) || &#123;&#125;;
   
    if (Tool.isEmpty(course) || Tool.isEmpty(chapter)) &#123;
      _this.$router.push(&quot;/welcome&quot;);
    &#125;
    _this.course = course;
    _this.chapter = chapter;
    _this.list(1);
  &#125;,
//////////////////////////////////////////////////列表查询两个参数
courseId: _this.course.id,
chapterId: _this.chapter.id
////////////////////////////////////////////////////保存给两个赋值
_this.section.courseId = _this.course.id;
_this.section.chapterId = _this.chapter.id;

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 增加SectionPageDto</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  package com.course.server.dto;</span><br><span class="line">  </span><br><span class="line">  public class SectionPageDto extends PageDto &#123;</span><br><span class="line">  </span><br><span class="line">      private String courseId;</span><br><span class="line">  </span><br><span class="line">      private String chapterId;</span><br><span class="line">  </span><br><span class="line">      public String getCourseId() &#123;</span><br><span class="line">          return courseId;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      public void setCourseId(String courseId) &#123;</span><br><span class="line">          this.courseId = courseId;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      public String getChapterId() &#123;</span><br><span class="line">          return chapterId;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      public void setChapterId(String chapterId) &#123;</span><br><span class="line">          this.chapterId = chapterId;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      @Override</span><br><span class="line">      public String toString() &#123;</span><br><span class="line">          final StringBuffer sb = new StringBuffer(&quot;SectionPageDto&#123;&quot;);</span><br><span class="line">          sb.append(&quot;courseId=&#x27;&quot;).append(courseId).append(&#x27;\&#x27;&#x27;);</span><br><span class="line">          sb.append(&quot;, chapterId=&#x27;&quot;).append(chapterId).append(&#x27;\&#x27;&#x27;);</span><br><span class="line">          sb.append(&quot;, page=&quot;).append(page);</span><br><span class="line">          sb.append(&quot;, size=&quot;).append(size);</span><br><span class="line">          sb.append(&quot;, total=&quot;).append(total);</span><br><span class="line">          sb.append(&quot;, list=&quot;).append(list);</span><br><span class="line">          sb.append(&#x27;&#125;&#x27;);</span><br><span class="line">          return sb.toString();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>然后对SectionController修改</p>
</li>
<li><p>&#96;&#96;&#96;java<br>&#x2F;**</p>
<ul>
<li>列表查询</li>
</ul>
<p>*&#x2F;<br>@PostMapping(“&#x2F;list”)<br>public ResponseDto list(@RequestBody SectionPageDto sectionPageDto){<br>    ResponseDto responseDto &#x3D; new ResponseDto();<br>    ValidatorUtil.require(sectionPageDto.getCourseId(), “课程ID”);<br>    ValidatorUtil.require(sectionPageDto.getChapterId(), “大章ID”);<br>    sectionService.list(sectionPageDto);<br>    responseDto.setContent(sectionPageDto);<br>    return responseDto;<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 最后对SectionService，criteria相当于写where语句</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  /**</span><br><span class="line">   * 列表查询</span><br><span class="line">   */</span><br><span class="line">  public void list(SectionPageDto sectionPageDto)&#123;</span><br><span class="line">      PageHelper.startPage(sectionPageDto.getPage(),sectionPageDto.getSize());</span><br><span class="line">      SectionExample sectionExample = new SectionExample();</span><br><span class="line">      SectionExample.Criteria criteria = sectionExample.createCriteria();</span><br><span class="line">      if (!StringUtils.isEmpty(sectionPageDto.getCourseId())) &#123;</span><br><span class="line">          criteria.andCourseIdEqualTo(sectionPageDto.getCourseId());</span><br><span class="line">      &#125;</span><br><span class="line">      if (!StringUtils.isEmpty(sectionPageDto.getChapterId())) &#123;</span><br><span class="line">          criteria.andChapterIdEqualTo(sectionPageDto.getChapterId());</span><br><span class="line">      &#125;</span><br><span class="line">      sectionExample.setOrderByClause(&quot;sort asc&quot;);</span><br><span class="line">      List&lt;Section&gt; sectionList = sectionMapper.selectByExample(sectionExample);</span><br><span class="line">      PageInfo&lt;Section&gt; pageInfo =new PageInfo&lt;&gt;(sectionList);</span><br><span class="line">      sectionPageDto.setTotal(pageInfo.getTotal());</span><br><span class="line">      ArrayList&lt;SectionDto&gt; sectionDtoArrayList = new ArrayList&lt;SectionDto&gt;();</span><br><span class="line">      for (int i = 0, l=sectionList.size(); i &lt;l ; i++) &#123;</span><br><span class="line">          Section section = sectionList.get(i);</span><br><span class="line">          SectionDto sectionDto = new SectionDto();</span><br><span class="line">          BeanUtils.copyProperties(section,sectionDto);</span><br><span class="line">          sectionDtoArrayList.add(sectionDto);</span><br><span class="line">      &#125;</span><br><span class="line">      sectionPageDto.setList(sectionDtoArrayList);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="7-2-课程时长的保存和显示"><a href="#7-2-课程时长的保存和显示" class="headerlink" title="7-2 课程时长的保存和显示"></a>7-2 课程时长的保存和显示</h2><p>保存节时，更新课程总时长</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.保存节时，更新课程总时长</span><br><span class="line">2.增加自定义mapper</span><br></pre></td></tr></table></figure>

<ul>
<li><p>自定义的xml要和自动生成的xml分开，所以再server的mapper中都增加两个文件夹my一个存入MyCourseMapper.java，一个MyCourseMapper.xml</p>
</li>
<li><pre><code class="java">package com.course.server.mapper.my;

import org.apache.ibatis.annotations.Param;

public interface MyCourseMapper &#123;
    int updateTime(@Param(&quot;courseId&quot;) String courseId);

&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```xml</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.course.server.mapper.my.MyCourseMapper&quot; &gt;</span><br><span class="line">    &lt;update id=&quot;updateTime&quot;&gt;</span><br><span class="line">        update course c set `time` = (select sum(`time`) from `section` where course_id = #&#123;courseId&#125;)</span><br><span class="line">        where c.id = #&#123;courseId&#125;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>代码规范提示SectionService不要直接调用course的mapper，而是调用平级的CourseService。这时就需要将MyCourseMapper在CourseService封装一下</p>
</li>
<li><pre><code>private static final Logger LOG = LoggerFactory.getLogger(CourseService.class);
@Resource
private MyCourseMapper myCourseMapper;
/**
* 更新课程时长
* @param courseId
* @return
*/
public void updateTime(String courseId) &#123;
    LOG.info(&quot;更新课程时长：&#123;&#125;&quot;, courseId);
    myCourseMapper.updateTime(courseId);
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 在SectionService使用</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  @Resource</span><br><span class="line">  private CourseService courseService;</span><br><span class="line">  在保存中添加</span><br><span class="line">  courseService.updateTime(sectionDto.getCourseId());</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>因为我们在mapper下新增个文件夹所以application.properties也要改</p>
</li>
<li><pre><code>mybatis.mapper-locations=classpath:/mapper/**/*.xml
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">增加事务处理：</span><br><span class="line"></span><br><span class="line">- 一次操作会更新或修改多张表，一般为了保证数据一致，需要增加事务处理</span><br><span class="line"></span><br><span class="line">- 在server的config增加TransactionManagementConfig</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  package com.course.server.config;</span><br><span class="line">  </span><br><span class="line">  import org.springframework.context.annotation.Configuration;</span><br><span class="line">  import org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line">  </span><br><span class="line">  @EnableTransactionManagement</span><br><span class="line">  @Configuration</span><br><span class="line">  public class TransactionManagementConfig &#123;</span><br><span class="line">     </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>使用时只需要在你想使用的方法上加@Transactional</p>
</li>
<li><p>数据保存进数据库了，说明事务没有回滚，事务不起作用</p>
</li>
<li><p>自定义异常一般可以选择继承RuntimeException。</p>
</li>
<li><p>同一个类的内部方法互相调用，methodA调用methodB，methodB事务不起作用。Spring的事务处理是利用AOP生成动态代理类，内部方法调用时不经过代理类，所以事务不生效</p>
</li>
</ul>
<p>增加时长格式化filter：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.增加时长格式化filter format..Second</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在filter增加</p>
</li>
<li><p>&#96;&#96;&#96;js<br>&#x2F;**</p>
<ul>
<li>时长格式化</li>
<li>@param value 例如：36000</li>
<li>@returns {string} 例如：10:00:00</li>
</ul>
<p> *&#x2F;<br>let format..Second &#x3D; (value) &#x3D;&gt; {<br>    value &#x3D; value || 0;<br>    let second &#x3D; parseInt(value, 10); &#x2F;&#x2F; 秒<br>    let minute &#x3D; 0; &#x2F;&#x2F; 分<br>    let hour &#x3D; 0; &#x2F;&#x2F; 小时<br>    if (second &gt;&#x3D; 60) {<br>        &#x2F;&#x2F; 当大于60秒时，才需要做转换<br>        minute &#x3D; Math.floor(second &#x2F; 60);<br>        second &#x3D; Math.floor(second % 60);<br>        if (minute &gt;&#x3D; 60) {<br>            hour &#x3D; Math.floor(minute &#x2F; 60);<br>            minute &#x3D; Math.floor(minute % 60);<br>        }<br>    } else {<br>        &#x2F;&#x2F; 小于60秒时，直接显示，不需要处理<br>    }<br>    let result &#x3D; “” + PrefixInteger(second, 2) + “”;<br>    &#x2F;&#x2F; 拼上分钟<br>    result &#x3D; “” + PrefixInteger(minute, 2) + “:” + result;<br>    &#x2F;&#x2F; 拼上小时<br>    result &#x3D; “” + PrefixInteger(hour, 2) + “:” + result;<br>    return result;<br>};</p>
<p>&#x2F;**</p>
<ul>
<li>格式化指定长度，前面补0</li>
</ul>
<p> *&#x2F;<br>function PrefixInteger(num, length) {<br>    return (Array(length).join(‘0’) + num).slice(-length);<br>}<br>export default {<br>    option..KV,<br>    format..Second<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 使用的时候直接在时间后加过滤器</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  &lt;td&gt;两个大括号包住section.time | format..Second&lt;/td&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="7-3-分类管理功能的开发"><a href="#7-3-分类管理功能的开发" class="headerlink" title="7-3 分类管理功能的开发"></a>7-3 分类管理功能的开发</h2><p>分类表设计和基本代码生成：</p>
<ul>
<li><p>首先设计数据库</p>
</li>
<li><pre><code class="sql"># 分类
DROP TABLE IF EXISTS `category`;
create table `category`
(
    `id`         CHAR(8)     NOT NULL DEFAULT &#39;&#39; COMMENT &#39;id&#39;,
    `parent`         CHAR(8)     NOT NULL DEFAULT &#39;&#39; COMMENT &#39;父id&#39;,
    `name`      VARCHAR(50) NOT NULL COMMENT &#39;名称&#39;,
    `sort`       INT COMMENT &#39;顺序&#39;,
    PRIMARY KEY (`id`)
   )engine =innodb default charset=utf8mb4 comment=&#39;分类&#39;;

insert into `category` (id,parent,name,sort) values (&#39;00000100&#39;,&#39;00000000&#39;,&#39;前端技术&#39;,100);
insert into `category` (id,parent,name,sort) values (&#39;00000101&#39;,&#39;00000100&#39;,&#39;html/css&#39;,101);
insert into `category` (id,parent,name,sort) values (&#39;00000102&#39;,&#39;00000100&#39;,&#39;javascript&#39;,102);
insert into `category` (id,parent,name,sort) values (&#39;00000103&#39;,&#39;00000100&#39;,&#39;vue.js&#39;,103);
insert into `category` (id,parent,name,sort) values (&#39;00000104&#39;,&#39;00000100&#39;,&#39;react.js&#39;,104);
insert into `category` (id,parent,name,sort) values (&#39;00000105&#39;,&#39;00000100&#39;,&#39;angular&#39;,105);
insert into `category` (id,parent,name,sort) values (&#39;00000106&#39;,&#39;00000100&#39;,&#39;node.js&#39;,106);
insert into `category` (id,parent,name,sort) values (&#39;00000107&#39;,&#39;00000100&#39;,&#39;jquery&#39;,107);
insert into `category` (id,parent,name,sort) values (&#39;00000108&#39;,&#39;00000100&#39;,&#39;小程序&#39;,108);
insert into `category` (id,parent,name,sort) values (&#39;00000200&#39;,&#39;00000000&#39;,&#39;后端技术&#39;,200);
insert into `category` (id,parent,name,sort) values (&#39;00000201&#39;,&#39;00000200&#39;,&#39;java&#39;,201);
insert into `category` (id,parent,name,sort) values (&#39;00000202&#39;,&#39;00000200&#39;,&#39;springboot&#39;,202);
insert into `category` (id,parent,name,sort) values (&#39;00000203&#39;,&#39;00000200&#39;,&#39;spring cloud&#39;,203);
insert into `category` (id,parent,name,sort) values (&#39;00000204&#39;,&#39;00000200&#39;,&#39;ssm&#39;,204);
insert into `category` (id,parent,name,sort) values (&#39;00000205&#39;,&#39;00000200&#39;,&#39;python&#39;,205);
insert into `category` (id,parent,name,sort) values (&#39;00000206&#39;,&#39;00000200&#39;,&#39;爬虫&#39;,206);
insert into `category` (id,parent,name,sort) values (&#39;00000300&#39;,&#39;00000000&#39;,&#39;移动开发&#39;,300);
insert into `category` (id,parent,name,sort) values (&#39;00000301&#39;,&#39;00000000&#39;,&#39;android&#39;,301);
insert into `category` (id,parent,name,sort) values (&#39;00000302&#39;,&#39;00000000&#39;,&#39;ios&#39;,302);
insert into `category` (id,parent,name,sort) values (&#39;00000303&#39;,&#39;00000000&#39;,&#39;react native&#39;,303);
insert into `category` (id,parent,name,sort) values (&#39;00000304&#39;,&#39;00000000&#39;,&#39;ionic&#39;,304);
insert into `category` (id,parent,name,sort) values (&#39;00000400&#39;,&#39;00000000&#39;,&#39;前沿技术&#39;,400);
insert into `category` (id,parent,name,sort) values (&#39;00000401&#39;,&#39;00000000&#39;,&#39;微服务&#39;,401);
insert into `category` (id,parent,name,sort) values (&#39;00000402&#39;,&#39;00000000&#39;,&#39;区块链&#39;,402);
insert into `category` (id,parent,name,sort) values (&#39;00000403&#39;,&#39;00000000&#39;,&#39;机器学习&#39;,403);
insert into `category` (id,parent,name,sort) values (&#39;00000404&#39;,&#39;00000000&#39;,&#39;深度学习&#39;,404);
insert into `category` (id,parent,name,sort) values (&#39;00000405&#39;,&#39;00000000&#39;,&#39;数据分析&amp;挖掘&#39;,405);
insert into `category` (id,parent,name,sort) values (&#39;00000500&#39;,&#39;00000000&#39;,&#39;云计算&amp;大数据&#39;,500);
insert into `category` (id,parent,name,sort) values (&#39;00000501&#39;,&#39;00000000&#39;,&#39;大数据&#39;,501);
insert into `category` (id,parent,name,sort) values (&#39;00000502&#39;,&#39;00000000&#39;,&#39;hadoop&#39;,502);
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 接下来mybatis-generator、前端后端生成器生成下，然后改下admin增加分类管理，然后路由增加下。</span><br><span class="line"></span><br><span class="line">分类的二级列表查询与显示：</span><br><span class="line"></span><br><span class="line">- 做成两个表格，左边一个表格是一级分类，右边是二级分类。点击一级分类时显示二级分类。</span><br><span class="line"></span><br><span class="line">- 首先在CategoryService中添加</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  /**</span><br><span class="line">  * 列表查询</span><br><span class="line">  */</span><br><span class="line">      public List&lt;CategoryDto&gt; all( ) &#123;</span><br><span class="line">          CategoryExample categoryExample = new CategoryExample();</span><br><span class="line">          categoryExample.setOrderByClause(&quot;sort asc&quot;);</span><br><span class="line">          List&lt;Category&gt; categoryList = categoryMapper.selectByExample(categoryExample);</span><br><span class="line">          List&lt;CategoryDto&gt; categoryDtoList = CopyUtil.copyList(categoryList, CategoryDto.class);</span><br><span class="line">          return categoryDtoList;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>接着在CategoryController增加</p>
</li>
<li><pre><code class="java">/**
* 列表查询
*/
@PostMapping(&quot;/all&quot;)
public ResponseDto all()&#123;
    ResponseDto responseDto = new ResponseDto();
    List&lt;CategoryDto&gt; categoryDtoList = categoryService.all();
    responseDto.setContent(categoryDtoList);
    return responseDto;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 然后再category.vue将分页全都删了，增加</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;business-category&#x27;,</span><br><span class="line">    data: function () &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        category: &#123;&#125;,</span><br><span class="line">        categorys: [],</span><br><span class="line">        level1: [],</span><br><span class="line">        level2: [],</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted: function () &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      _this.all();</span><br><span class="line">    &#125;,</span><br><span class="line">    /////////////////////////////////////////////修改list</span><br><span class="line">     /**</span><br><span class="line">       * 列表查询</span><br><span class="line">       */</span><br><span class="line">      all() &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        Loading.show();</span><br><span class="line">        _this.$ajax.post(process.env.VUE_APP_SERVER +&#x27;/business/admin/category/all&#x27;).then((respond) =&gt; &#123;</span><br><span class="line">          Loading.hide();</span><br><span class="line">          let resp = respond.data;</span><br><span class="line">          _this.categorys = resp.content;</span><br><span class="line">          //将所有记录格式化成树形结构</span><br><span class="line">          for (let i = 0; i &lt; _this.categorys.length; i++) &#123;</span><br><span class="line">            let c =_this.categorys[i];</span><br><span class="line">            if(c.parent === &#x27;00000000&#x27;)&#123;</span><br><span class="line">              _this.level1.push(c);</span><br><span class="line">              for (let j = 0; j &lt; _this.categorys.length; j++) &#123;</span><br><span class="line">                let child =_this.categorys[j];</span><br><span class="line">                if(child.parent === c.id)&#123;</span><br><span class="line">                  if(Tool.isEmpty(c.children))&#123;</span><br><span class="line">                    c.children = [];</span><br><span class="line">                  &#125;</span><br><span class="line">                  c.children.push(child);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>level1的数据增加childern属性，用于存放它所有的二级分类</p>
</li>
<li><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/04/8G7p5sV4nTYwcyS.png"
                      alt="image-20220304160059706"
                ></p>
</li>
<li><p>左边一个表格是一级分类，右边是二级分类：简单来说就是再 <div class="col-md-6">中加了两个table。</p>
</li>
<li><pre><code class="vue">&lt;div class=&quot;row&quot;&gt;
  &lt;div class=&quot;col-md-6&quot;&gt;
    &lt;p&gt;
      &lt;button v-on:click=&quot;add()&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;
        &lt;i class=&quot;ace-icon fa fa-edit red2&quot;&gt;&lt;/i&gt;
        新增
      &lt;/button&gt;
      &amp;nbsp;
      &lt;button v-on:click=&quot;all()&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;
        &lt;i class=&quot;ace-icon fa fa-refresh red2&quot;&gt;&lt;/i&gt;
        刷新
      &lt;/button&gt;
    &lt;/p&gt;
    &lt;table id=&quot;level1-table&quot; class=&quot;table  table-bordered table-hover&quot;&gt;
      &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;id&lt;/th&gt;
        &lt;th&gt;名称&lt;/th&gt;
        &lt;th&gt;顺序&lt;/th&gt;
        &lt;th&gt;操作&lt;/th&gt;
      &lt;/tr&gt;
      &lt;/thead&gt;

      &lt;tbody&gt;
      &lt;tr v-for=&quot;category in level1&quot; v-on:click=&quot;onClickLevel1(category)&quot;&gt;
        &lt;td&gt;&#123;&#123;category.id&#125;&#125;&lt;/td&gt;
        &lt;td&gt;&#123;&#123;category.name&#125;&#125;&lt;/td&gt;
        &lt;td&gt;&#123;&#123;category.sort&#125;&#125;&lt;/td&gt;

        &lt;td&gt;
          &lt;div class=&quot;hidden-sm hidden-xs btn-group&quot;&gt;

            &lt;button v-on:click=&quot;edit(category)&quot; class=&quot;btn btn-xs btn-info&quot;&gt;
              &lt;i class=&quot;ace-icon fa fa-pencil bigger-120&quot;&gt;&lt;/i&gt;
            &lt;/button&gt;

            &lt;button v-on:click=&quot;del(category.id)&quot; class=&quot;btn btn-xs btn-danger&quot;&gt;
              &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;
            &lt;/button&gt;

          &lt;/div&gt;

          &lt;div class=&quot;hidden-md hidden-lg&quot;&gt;
            &lt;div class=&quot;inline pos-rel&quot;&gt;
              &lt;button class=&quot;btn btn-minier btn-primary dropdown-toggle&quot; data-toggle=&quot;dropdown&quot; data-position=&quot;auto&quot;&gt;
                &lt;i class=&quot;ace-icon fa fa-cog icon-only bigger-110&quot;&gt;&lt;/i&gt;
              &lt;/button&gt;

              &lt;ul class=&quot;dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close&quot;&gt;
                &lt;li&gt;
                  &lt;a href=&quot;#&quot; class=&quot;tooltip-info&quot; data-rel=&quot;tooltip&quot; title=&quot;View&quot;&gt;
               &lt;span class=&quot;blue&quot;&gt;
                &lt;i class=&quot;ace-icon fa fa-search-plus bigger-120&quot;&gt;&lt;/i&gt;
               &lt;/span&gt;
                  &lt;/a&gt;
                &lt;/li&gt;

                &lt;li&gt;
                  &lt;a href=&quot;#&quot; class=&quot;tooltip-success&quot; data-rel=&quot;tooltip&quot; title=&quot;Edit&quot;&gt;
               &lt;span class=&quot;green&quot;&gt;
                &lt;i class=&quot;ace-icon fa fa-pencil-square-o bigger-120&quot;&gt;&lt;/i&gt;
               &lt;/span&gt;
                  &lt;/a&gt;
                &lt;/li&gt;

                &lt;li&gt;
                  &lt;a href=&quot;#&quot; class=&quot;tooltip-error&quot; data-rel=&quot;tooltip&quot; title=&quot;Delete&quot;&gt;
               &lt;span class=&quot;red&quot;&gt;
                &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;
               &lt;/span&gt;
                  &lt;/a&gt;
                &lt;/li&gt;
              &lt;/ul&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;

  &lt;/div&gt;
  &lt;div class=&quot;col-md-6&quot;&gt;
    &lt;p&gt;
      &lt;button v-on:click=&quot;add()&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;
        &lt;i class=&quot;ace-icon fa fa-edit red2&quot;&gt;&lt;/i&gt;
        新增
      &lt;/button&gt;
      &amp;nbsp;
      &lt;button v-on:click=&quot;all()&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;
        &lt;i class=&quot;ace-icon fa fa-refresh red2&quot;&gt;&lt;/i&gt;
        刷新
      &lt;/button&gt;
    &lt;/p&gt;
    &lt;table id=&quot;level2-table&quot; class=&quot;table  table-bordered table-hover&quot;&gt;
      &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;id&lt;/th&gt;
        &lt;th&gt;名称&lt;/th&gt;
        &lt;th&gt;顺序&lt;/th&gt;
        &lt;th&gt;操作&lt;/th&gt;
      &lt;/tr&gt;
      &lt;/thead&gt;

      &lt;tbody&gt;
      &lt;tr v-for=&quot;category in level2&quot; &gt;
        &lt;td&gt;&#123;&#123;category.id&#125;&#125;&lt;/td&gt;
        &lt;td&gt;&#123;&#123;category.name&#125;&#125;&lt;/td&gt;
        &lt;td&gt;&#123;&#123;category.sort&#125;&#125;&lt;/td&gt;

        &lt;td&gt;
          &lt;div class=&quot;hidden-sm hidden-xs btn-group&quot;&gt;

            &lt;button v-on:click=&quot;edit(category)&quot; class=&quot;btn btn-xs btn-info&quot;&gt;
              &lt;i class=&quot;ace-icon fa fa-pencil bigger-120&quot;&gt;&lt;/i&gt;
            &lt;/button&gt;

            &lt;button v-on:click=&quot;del(category.id)&quot; class=&quot;btn btn-xs btn-danger&quot;&gt;
              &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;
            &lt;/button&gt;

          &lt;/div&gt;

          &lt;div class=&quot;hidden-md hidden-lg&quot;&gt;
            &lt;div class=&quot;inline pos-rel&quot;&gt;
              &lt;button class=&quot;btn btn-minier btn-primary dropdown-toggle&quot; data-toggle=&quot;dropdown&quot; data-position=&quot;auto&quot;&gt;
                &lt;i class=&quot;ace-icon fa fa-cog icon-only bigger-110&quot;&gt;&lt;/i&gt;
              &lt;/button&gt;

              &lt;ul class=&quot;dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close&quot;&gt;
                &lt;li&gt;
                  &lt;a href=&quot;#&quot; class=&quot;tooltip-info&quot; data-rel=&quot;tooltip&quot; title=&quot;View&quot;&gt;
               &lt;span class=&quot;blue&quot;&gt;
                &lt;i class=&quot;ace-icon fa fa-search-plus bigger-120&quot;&gt;&lt;/i&gt;
               &lt;/span&gt;
                  &lt;/a&gt;
                &lt;/li&gt;

                &lt;li&gt;
                  &lt;a href=&quot;#&quot; class=&quot;tooltip-success&quot; data-rel=&quot;tooltip&quot; title=&quot;Edit&quot;&gt;
               &lt;span class=&quot;green&quot;&gt;
                &lt;i class=&quot;ace-icon fa fa-pencil-square-o bigger-120&quot;&gt;&lt;/i&gt;
               &lt;/span&gt;
                  &lt;/a&gt;
                &lt;/li&gt;

                &lt;li&gt;
                  &lt;a href=&quot;#&quot; class=&quot;tooltip-error&quot; data-rel=&quot;tooltip&quot; title=&quot;Delete&quot;&gt;
               &lt;span class=&quot;red&quot;&gt;
                &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;
               &lt;/span&gt;
                  &lt;/a&gt;
                &lt;/li&gt;
              &lt;/ul&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;

  &lt;/div&gt;
&lt;/div&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 为左边表增加点击事件，点击右边就显示子表</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  onClickLevel1(category)&#123;</span><br><span class="line">    let _this =this;</span><br><span class="line">    _this.level2 =category.children;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>出现问题一：点击刷新的时候，会重复增加，主要是因为all事件每次都会将level1push<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/04/mITPCRfrskdY2Ee.png"
                      alt="image-20220304165944171"
                ></p>
</li>
<li><p>解决只需要再每次格式化前将level1清空即增加_this.level1 &#x3D;[];</p>
</li>
<li><p>问题二：点击左边的，出来右边时，我们需要增加一个激活效果<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/04/LMTYs7igUP2ItEh.png"
                      alt="image-20220304170305414"
                ></p>
</li>
<li><p>动态class：使用v-bind:class&#x3D;json表达式，key就是样式，value是boolean，为true时，表示key的样式生效。可以和原生的class并存</p>
</li>
<li><pre><code>///////////////////////////////////////////////////////////////
&lt;tr v-for=&quot;category in level1&quot; v-on:click=&quot;onClickLevel1(category)&quot; v-bind:class=&quot;&#123;&#39;active&#39;: category.id === active.id&#125;&quot;&gt;
////////////////////////////////////////////////////
data: function () &#123;
    return &#123;
      category: &#123;&#125;,
      categorys: [],
      level1: [],
      level2: [],
      active: &#123;&#125;,//增加
    &#125;
  &#125;,
  /////////////////////////////////////////////////
   onClickLevel1(category) &#123;
        let _this = this;
        _this.active = category;
        _this.level2 = category.children;
      &#125;
    &#125;
  &#125;
 /////////////////////////////////////////////
&lt;style scoped&gt;
  .active td &#123;
    background-color: #d6e9c6 !important;
  &#125;
&lt;/style&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">两级分类的新增修改删除：</span><br><span class="line"></span><br><span class="line">- 将两个新增标签改成新增一级，新增二级，对应的方法改为add1(),add2()，将父id改成父分类</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">    &lt;label class=&quot;col-sm-2 control-label&quot;&gt;父分类&lt;/label&gt;</span><br><span class="line">    &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">      &lt;p  class=&quot;form-control-static&quot;&gt;&#123;&#123;active.name || &quot;无&quot;&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  //////////////////////////////////////////////////////////////////////////////////</span><br><span class="line">    /**</span><br><span class="line">       * 点击【新增一级】</span><br><span class="line">       */</span><br><span class="line">      add1() &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        _this.active = &#123;&#125;;</span><br><span class="line">        _this.level2 = [];</span><br><span class="line">        _this.category = &#123;</span><br><span class="line">          parent:&quot;00000000&quot;</span><br><span class="line">        &#125;;</span><br><span class="line">        $(&quot;#form-modal&quot;).modal(&quot;show&quot;);</span><br><span class="line">      &#125;,</span><br><span class="line">      /**</span><br><span class="line">       * 点击【新增二级】</span><br><span class="line">       */</span><br><span class="line">      add2() &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        if(Tool.isEmpty(_this.active))&#123;</span><br><span class="line">          Toast.warning(&quot;请先点击一级分类&quot;);</span><br><span class="line">          return;</span><br><span class="line">        &#125;</span><br><span class="line">        _this.category = &#123;</span><br><span class="line">          parent:_this.active.id</span><br><span class="line">        &#125;;</span><br><span class="line">        $(&quot;#form-modal&quot;).modal(&quot;show&quot;);</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>修改CategoryService</p>
</li>
<li><pre><code class="java">/**
 * 删除
 */
@Transactional
public void delete(String id)&#123;
    deleteChildren(id);
    categoryMapper.deleteByPrimaryKey(id);
&#125;
/**
 * 删除子分类
 * @param id
 */
public void deleteChildren(String id) &#123;
    Category category = categoryMapper.selectByPrimaryKey(id);
    if (&quot;00000000&quot;.equals(category.getParent())) &#123;
        // 如果是一级分类，需要删除其下的二级分类
        CategoryExample example = new CategoryExample();
        example.createCriteria().andParentEqualTo(category.getId());
        categoryMapper.deleteByExample(example);
    &#125;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 问题：新增、编辑、删除二级分类时，没有马上刷新出来，会用到另一个小知识点</span><br><span class="line"></span><br><span class="line">- 处理：对一级或二级分类的增删改查，都会调用all()刷新数据，所以all()的后面触发一次表格行点击事件。</span><br><span class="line"></span><br><span class="line">```vue</span><br><span class="line">_this.level2 =[];</span><br><span class="line">  //对当前一级分类中选中的表格触发一次点击事件，以刷新二级菜单栏</span><br><span class="line">  //注意：界面的渲染需要等vue绑定好变量后才做，所以延迟100ms</span><br><span class="line">  setTimeout(function ()&#123;</span><br><span class="line">    $(&quot;tr.active&quot;).trigger(&quot;click&quot;);</span><br><span class="line">  &#125;,100)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>小技巧：当界面又用了jquery（特别是第三插件），当觉得代码没问题，但是效果又没出来，可以加一个小延迟看看。</p>
</li>
</ul>
<h2 id="7-4-课程和分类关联保存和显示"><a href="#7-4-课程和分类关联保存和显示" class="headerlink" title="7-4 课程和分类关联保存和显示"></a>7-4 课程和分类关联保存和显示</h2><p>集成树型展示插件zTree：<a class="link"   target="_blank" rel="noopener" href="http://www.treejs.cn/v3/main.php#_zTreeInfo" >http://www.treejs.cn/v3/main.php#_zTreeInfo<i class="fas fa-external-link-alt"></i></a></p>
<ul>
<li><p>先弄成这个样式：<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/05/dRaPCEKfeHr5jcs.png"
                      alt="image-20220305153046685"
                ></p>
</li>
<li><p>zTree是jquery插件，用于展示树型结构数据。分类数据有两层结构，可用树形结构展示。</p>
</li>
<li><p>首先再index中引入</p>
</li>
<li><p>&#96;&#96;&#96;html</p>
<!--  zTree jquery树插件  -->
<link rel="stylesheet" href="<%= BASE_URL %>zTree_v3/css/zTreeStyle/zTreeStyle.css" type="text/css">
///////////////////////////////////
<!--  zTree jquery树插件  -->
<script src="<%= BASE_URL %>zTree_v3-master/js/jquery.ztree.core.min.js"></script>
<script src="<%= BASE_URL %>zTree_v3-master/js/jquery.ztree.excheck.min.js"></script>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 功能设计：新增课程的时候，同时选择这门课程属于哪些分类，并且一门课程可以属于多个分类。</span><br><span class="line"></span><br><span class="line">- 再course.vue表单下添加</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">    &lt;label class=&quot;col-sm-2 control-label&quot;&gt;</span><br><span class="line">      分类</span><br><span class="line">    &lt;/label&gt;</span><br><span class="line">    &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">      &lt;ul id=&quot;tree&quot; class=&quot;ztree&quot;&gt;&lt;/ul&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  /////////////////////////////////初始化时</span><br><span class="line">     _this.initTree();</span><br><span class="line">  ////////////////////////////////////////</span><br><span class="line">      initTree()&#123;</span><br><span class="line">        let setting = &#123;</span><br><span class="line">          check: &#123;</span><br><span class="line">            enable: true</span><br><span class="line">          &#125;,</span><br><span class="line">          data: &#123;</span><br><span class="line">            simpleData: &#123;</span><br><span class="line">              enable: true</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">  </span><br><span class="line">        let zNodes =[</span><br><span class="line">          &#123; id:1, pId:0, name:&quot;随意勾选 1&quot;, open:true&#125;,</span><br><span class="line">          &#123; id:11, pId:1, name:&quot;随意勾选 1-1&quot;, open:true&#125;,</span><br><span class="line">          &#123; id:111, pId:11, name:&quot;随意勾选 1-1-1&quot;&#125;,</span><br><span class="line">          &#123; id:112, pId:11, name:&quot;随意勾选 1-1-2&quot;&#125;,</span><br><span class="line">          &#123; id:12, pId:1, name:&quot;随意勾选 1-2&quot;, open:true&#125;,</span><br><span class="line">          &#123; id:121, pId:12, name:&quot;随意勾选 1-2-1&quot;&#125;,</span><br><span class="line">          &#123; id:122, pId:12, name:&quot;随意勾选 1-2-2&quot;&#125;,</span><br><span class="line">          &#123; id:2, pId:0, name:&quot;随意勾选 2&quot;, checked:true, open:true&#125;,</span><br><span class="line">          &#123; id:21, pId:2, name:&quot;随意勾选 2-1&quot;&#125;,</span><br><span class="line">          &#123; id:22, pId:2, name:&quot;随意勾选 2-2&quot;, open:true&#125;,</span><br><span class="line">          &#123; id:221, pId:22, name:&quot;随意勾选 2-2-1&quot;, checked:true&#125;,</span><br><span class="line">          &#123; id:222, pId:22, name:&quot;随意勾选 2-2-2&quot;&#125;,</span><br><span class="line">          &#123; id:23, pId:2, name:&quot;随意勾选 2-3&quot;&#125;</span><br><span class="line">        ];</span><br><span class="line">        $.fn.zTree.init($(&quot;#tree&quot;), setting, zNodes);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>将其改成这样：1.zTree数据改为分类所有记录<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/05/jo7QPzke8GR2TYm.png"
                      alt="image-20220305153545604"
                ></p>
<ul>
<li><p>首先将category中all方法复制修改到course中，然后初始值，接着将初始initTree更改初始allCategory，然后再allCategory中使用initTree（在第八行），接着将分支写入tree中，最后pId是zTree默认的父ID名称，而分类表是用parent，需要配置转换</p>
</li>
<li><p>&#96;&#96;&#96;<br>&#x2F;&#x2F;首先将category中all方法复制修改到course中<br>allCategory() {<br>  let _this &#x3D; this;<br>  Loading.show();<br>  _this.$ajax.post(process.env.VUE_APP_SERVER +’&#x2F;business&#x2F;admin&#x2F;category&#x2F;all’).then((respond) &#x3D;&gt; {<br>Loading.hide();<br>let resp &#x3D; respond.data;<br>_this.categorys &#x3D; resp.content;<br>_this.initTree();&#x2F;&#x2F;然后再allCategory中使用initTree<br>  })<br>},<br>&#x2F;&#x2F;然后初始值<br>categorys: [],<br>&#x2F;&#x2F;接着将初始initTree更改初始allCategory<br> _this.allCategory();<br> &#x2F;&#x2F;将分支写入tree中<br>let zNodes &#x3D; _this.categorys;<br>&#x2F;&#x2F;pId是zTree默认的父ID名称，而分类表是用parent，需要配置转换<br> data: {<br>      simpleData: {<br>        idKey:”id”,<br>        pIdKey:”parent”,<br>        rootPId:”00000000”,<br>        enable: true<br>      }<br>    }</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">保存课程时，同时保存课程分类：</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>1.保存课程时，同时保存课程分类<br>2.增加课程分类关联表，一门课程可以属于多个分类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 首先创建sql语句</span><br><span class="line"></span><br><span class="line">- ```sql</span><br><span class="line">  #课程分类</span><br><span class="line">  DROP TABLE IF EXISTS `course_category`;</span><br><span class="line">  create table `course_category`(</span><br><span class="line">              `id` char(8) not null default &#x27;&#x27; comment &#x27;id&#x27;,</span><br><span class="line">              `course_id` char(8) comment &#x27;课程|course.id&#x27;,</span><br><span class="line">              `category_id` char(8) comment &#x27;分类|course.id&#x27;,</span><br><span class="line">  </span><br><span class="line">               primary key (`id`)</span><br><span class="line">  )engine =innodb default charset=utf8mb4 comment=&#x27;课程分类&#x27;;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>接着就是代码生成器，不需要前端的，所以也不需要controller。</p>
</li>
<li><p>在course.vue中进行代码的修改</p>
</li>
<li><pre><code class="vue">//在data中定义tree
tree: &#123;&#125;,
//再保存中进行一些弹框提示
let categorys = _this.tree.getCheckedNodes();
if(Tool.isEmpty(categorys))&#123;
  Toast.warning(&quot;请选择分类!&quot;);
  return;
&#125;
_this.course.categorys =categorys;
//将这个赋值到tree
_this.tree = $.fn.zTree.init($(&quot;#tree&quot;), setting, zNodes);
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 在courseDto中增加一个变量</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  private List&lt;CategoryDto&gt; categorys;//属性名和前端传递的参数名一致，这样spring会自动映射参数</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>在CourseService中save中增加</p>
</li>
<li><pre><code class="java">@Resource
private CourseCategoryService courseCategoryService;
   
//批量保存课程分类
courseCategoryService.saveBatch(courseDto.getId(),courseDto.getCategorys());
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">- 在CourseCategoryService增加saveBatch方法</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  public void saveBatch(String courseId, List&lt;CategoryDto&gt; dtoList)&#123;</span><br><span class="line">      CourseCategoryExample example = new CourseCategoryExample();</span><br><span class="line">      example.createCriteria().andCourseIdEqualTo(courseId);</span><br><span class="line">      courseCategoryMapper.deleteByExample(example);</span><br><span class="line">      for (int i = 0,l = dtoList.size(); i &lt; l; i++) &#123;</span><br><span class="line">          CategoryDto categoryDto = dtoList.get(i);</span><br><span class="line">          CourseCategory courseCategory = new CourseCategory();</span><br><span class="line">          courseCategory.setId(UuidUtil.getShortUuid());</span><br><span class="line">          courseCategory.setCourseId(courseId);</span><br><span class="line">          courseCategory.setCategoryId(categoryDto.getId());</span><br><span class="line">          insert(courseCategory);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>我们只需要保存分类的ID，所以数据传输可以选择id数组，也可以选择category数组</p>
</li>
<li><p>也可以通过自定义的mapper写动态sql，将list传入mybatis，批量插入一批数据，只要一条insert语句。项目开发需要在开发效率和运行效率间找平衡。</p>
</li>
<li><p>问题：保存课程时，调用saveBatch，那么课程新增时，还会批量插入数据，课程更新时，会再次批量插入数据，每次调用保存都会批量插入数据</p>
</li>
</ul>
<p>编辑课程时，加载课程分类树，并设置勾选：</p>
<ul>
<li>首先在CourseService增加一个事务，</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 保存，id有值时更新，无值时新增</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>外层save增加了事务，saveBatch按理可以不加事务。但是由于本身也是多个sql操作，且以后可能被多个地方调用，为了防止外层save忘记加事务，所以在saveBatch加事务，以防外一。</p>
</li>
<li><p>在CourseCategoryService中增加,其次在saveBatch也增加一个事务</p>
</li>
<li><pre><code class="java">/**
  * 根据某一课程，前清空课程分类，再保存课程分类
  * @param courseId
  * @param dtoList
*/
@Transactional
///////////////////////////////////////////////
public List&lt;CourseCategoryDto&gt; listByCourse(String courseId)&#123;
    CourseCategoryExample example = new CourseCategoryExample();
    example.createCriteria().andCourseIdEqualTo(courseId);
    List&lt;CourseCategory&gt; courseCategoryList = courseCategoryMapper.selectByExample(example);
    return CopyUtil.copyList(courseCategoryList,CourseCategoryDto.class);
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 在coursecontroller中增加一个方法</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  /**</span><br><span class="line">  * 查找课程下所有分类</span><br><span class="line">  */</span><br><span class="line">  @PostMapping (&quot;/list-category/&#123;courseId&#125;&quot;)</span><br><span class="line">  public ResponseDto listCategory(@PathVariable(value = &quot;courseId&quot;)  String courseId)&#123;</span><br><span class="line">      ResponseDto responseDto = new ResponseDto();</span><br><span class="line">      List&lt;CourseCategoryDto&gt; dtoList = courseCategoryService.listByCourse(courseId);</span><br><span class="line">      responseDto.setContent(dtoList);</span><br><span class="line">      return responseDto;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>最后在course.vue中增加</p>
</li>
<li><pre><code class="vue">add() &#123;
  _this.tree.checkAllNodes(false);
&#125;,
/////////////////
edit(course) &#123;   
  _this.listCategory(course.id);
&#125;,
//////////////////////
 /**
     * 查找课程下所有分类
     * @param courseId
     */
    listCategory(courseId) &#123;
      let _this = this;
      Loading.show();
      _this.$ajax.post(process.env.VUE_APP_SERVER + &#39;/business/admin/course/list-category/&#39; + courseId).then((res)=&gt;&#123;
        Loading.hide();
        console.log(&quot;查找课程下所有分类结果：&quot;, res);
        let response = res.data;
        let categorys = response.content;

        // 勾选查询到的分类
        _this.tree.checkAllNodes(false);
        for (let i = 0; i &lt; categorys.length; i++) &#123;
          let node = _this.tree.getNodeByParam(&quot;id&quot;, categorys[i].categoryId);
          _this.tree.checkNode(node, true);
        &#125;
      &#125;)
    &#125;,
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 7-5 课程内容功能开发</span><br><span class="line"></span><br><span class="line">课程内容表的设计与基本代码的生成：</span><br><span class="line"></span><br><span class="line">- all.sql生成代码</span><br><span class="line"></span><br><span class="line">- ```sql</span><br><span class="line">  #课程内容</span><br><span class="line">  DROP TABLE IF EXISTS `course_content`;</span><br><span class="line">  create table `course_content`(</span><br><span class="line">              `id` char(8) not null default &#x27;&#x27; comment &#x27;课程id&#x27;,</span><br><span class="line">              `content` mediumtext not null  comment &#x27;课程内容&#x27;,</span><br><span class="line">               primary key (`id`)</span><br><span class="line">  )engine =innodb default charset=utf8mb4 comment=&#x27;课程内容&#x27;;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>课程表和课程内容表是1：1的关系，两张表都用同样的字段</p>
</li>
<li><p>课程详情一般会有文字，图片，视频等，虽然不会把整张图片或者整个视频放到数据库，但是存的信息还是很多，所以用大字段。mediumtext比text类型长度更长。</p>
</li>
<li><p>然后依旧mybatis和后端生成器生成代码。</p>
</li>
<li><p>表里有大字段时，就会生成withBLOBs方法（在service中）</p>
</li>
</ul>
<p>完成课程内容管理功能：</p>
<ul>
<li><p>富文本编辑器，一个很重要的特性：所见即所得</p>
</li>
<li><p>课程内容，只有读和写，没有列表查询，也没有删除</p>
</li>
<li><p>新增课程的时候，course表有数据，course_content表没有数据。</p>
</li>
<li><p>正常思路，先去select，看看有没有数据，再判断时insert还是update，这样会执行两个sql。其实可以直接更新，没有更新到再插入，只有第一次会更新不到，执行两次sql，后面都只需要一个sql</p>
</li>
<li><p>首先在CourseService中插入</p>
</li>
<li><pre><code class="java"> @Resource
 private CourseContentMapper courseContentMapper;
    
/**
 * 查找课程内容
 */
public CourseContentDto findContent(String id)&#123;
    CourseContent content = courseContentMapper.selectByPrimaryKey(id);
    if(content == null)&#123;
        return null;
    &#125;
    return CopyUtil.copy(content,CourseContentDto.class);
&#125;

/**
 * 保存课程内容，包含新增和修改
 */
public int saveContent(CourseContentDto contentDto)&#123;
    CourseContent content = CopyUtil.copy(contentDto,CourseContent.class);
    int i = courseContentMapper.updateByPrimaryKeyWithBLOBs(content);
    if (i == 0)&#123;
        i = courseContentMapper.insert(content);
    &#125;
    return i;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 其次在controller中将service中写的两个方法都暴露出去</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  @GetMapping (&quot;/find-content/&#123;id&#125;&quot;)</span><br><span class="line">  public ResponseDto findContent(@PathVariable  String id)&#123;</span><br><span class="line">      ResponseDto responseDto = new ResponseDto();</span><br><span class="line">      CourseContentDto contentDto = courseService.findContent(id);</span><br><span class="line">      responseDto.setContent(contentDto);</span><br><span class="line">      return responseDto;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">  @PostMapping(&quot;/save-content&quot;)</span><br><span class="line">  public ResponseDto saveContent(@RequestBody CourseContentDto contentDto) &#123;</span><br><span class="line">      ResponseDto responseDto = new ResponseDto();</span><br><span class="line">      courseService.saveContent(contentDto);</span><br><span class="line">      return responseDto;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>接着在index中引入富文本的css和js</p>
</li>
<li><p>&#96;&#96;&#96;html<br>!– include summernote css&#x2F;js –&gt;</p>
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 最後在course.vue中添加代碼</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  &lt;button v-on:click=&quot;editContent(course)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">    内容</span><br><span class="line">  &lt;/button&gt;&amp;nbsp;&amp;nbsp;</span><br><span class="line">  /////////////////////////////////////</span><br><span class="line">    &lt;div id=&quot;course-content-modal&quot; class=&quot;modal fade&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;modal-header&quot;&gt;</span><br><span class="line">              &lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;</span><br><span class="line">              &lt;h4 class=&quot;modal-title&quot;&gt;内容编辑&lt;/h4&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">              &lt;form class=&quot;form-horizontal&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                  &lt;div class=&quot;col-lg-12&quot;&gt;</span><br><span class="line">                    &lt;div id=&quot;content&quot;&gt;&lt;/div&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/form&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">              &lt;button type=&quot;button&quot; class=&quot;btn btn-default&quot; data-dismiss=&quot;modal&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-times&quot;&gt;&lt;/i&gt;</span><br><span class="line">                取消</span><br><span class="line">              &lt;/button&gt;</span><br><span class="line">              &lt;button v-on:click=&quot;saveContent()&quot; type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-plus blue&quot;&gt;&lt;/i&gt;</span><br><span class="line">                保存</span><br><span class="line">              &lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;&lt;!-- /.modal-content --&gt;</span><br><span class="line">        &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;</span><br><span class="line">      &lt;/div&gt;&lt;!-- /.modal --&gt;</span><br><span class="line">  ///////////////////////////////////////////////</span><br><span class="line">   /**</span><br><span class="line">       * 打开内容编辑</span><br><span class="line">       */</span><br><span class="line">      editContent(course) &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        let id = course.id;</span><br><span class="line">        _this.course =course;</span><br><span class="line">        $(&quot;#content&quot;).summernote(&#123;</span><br><span class="line">          focus: true,</span><br><span class="line">          height: 300</span><br><span class="line">        &#125;);</span><br><span class="line">  </span><br><span class="line">        // 先清空历史文本</span><br><span class="line">        $(&quot;#content&quot;).summernote(&#x27;code&#x27;, &#x27;&#x27;);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">        Loading.show();</span><br><span class="line">        _this.$ajax.get(process.env.VUE_APP_SERVER + &#x27;/business/admin/course/find-content/&#x27; + id).then((response)=&gt;&#123;</span><br><span class="line">          Loading.hide();</span><br><span class="line">          let resp = response.data;</span><br><span class="line">  </span><br><span class="line">          if (resp.success) &#123;</span><br><span class="line">            if (resp.content) &#123;</span><br><span class="line">              $(&quot;#content&quot;).summernote(&#x27;code&#x27;, resp.content.content);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            Toast.warning(resp.message);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">     </span><br><span class="line">      /**</span><br><span class="line">       * 保存内容</span><br><span class="line">       */</span><br><span class="line">      saveContent () &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        let content = $(&quot;#content&quot;).summernote(&quot;code&quot;);</span><br><span class="line">        _this.$ajax.post(process.env.VUE_APP_SERVER + &#x27;/business/admin/course/save-content&#x27;, &#123;</span><br><span class="line">          id: _this.course.id,</span><br><span class="line">          content: content</span><br><span class="line">        &#125;).then((response)=&gt;&#123;</span><br><span class="line">          Loading.hide();</span><br><span class="line">          let resp = response.data;</span><br><span class="line">          if (resp.success) &#123;</span><br><span class="line">            Toast.success(&quot;内容保存成功&quot;);</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            Toast.warning(resp.message);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure></li>
</ul>
<p>利用setInterval完成自動保存功能：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.利用setInterval完成自动保存功能</span><br><span class="line">2.增加js日期格式化方法</span><br></pre></td></tr></table></figure>

<ul>
<li><p>setInterval，重复的定时任务；setTimeout，只执行一次的定时任务</p>
</li>
<li><p>在editContent中增加。</p>
</li>
<li><pre><code class="vue">//自動保存功能
let saveContentInterval = setInterval(function ()&#123;
  _this.saveContent();
&#125;,5000);
//关闭内容框时，情况自动保存功能
$(&#39;course-content-modal&#39;).on(&#39;hidden.bs.modal&#39;,function (e)&#123;
  clearInterval(saveContentInterval);
&#125;)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20220307112732051](https://s2.loli.net/2022/03/07/5IEnyTGtJkpHu62.png)</span><br><span class="line"></span><br><span class="line">- 这样写右上角总是出现下面这个框，所以做以下修改，在tool.js增加一个日期格式化方法</span><br><span class="line"></span><br><span class="line">- ```js</span><br><span class="line">  /**</span><br><span class="line">   * 时间格式化，date为空时取当前时间</span><br><span class="line">   */</span><br><span class="line">  dateFormat: function (format, date) &#123;</span><br><span class="line">    let result;</span><br><span class="line">    if (!date) &#123;</span><br><span class="line">      date = new Date();</span><br><span class="line">    &#125;</span><br><span class="line">    const option = &#123;</span><br><span class="line">      &quot;y+&quot;: date.getFullYear().toString(),        // 年</span><br><span class="line">      &quot;M+&quot;: (date.getMonth() + 1).toString(),     // 月</span><br><span class="line">      &quot;d+&quot;: date.getDate().toString(),            // 日</span><br><span class="line">      &quot;h+&quot;: date.getHours().toString(),           // 时</span><br><span class="line">      &quot;m+&quot;: date.getMinutes().toString(),         // 分</span><br><span class="line">      &quot;s+&quot;: date.getSeconds().toString()          // 秒</span><br><span class="line">    &#125;;</span><br><span class="line">    for (let i in option) &#123;</span><br><span class="line">      result = new RegExp(&quot;(&quot; + i + &quot;)&quot;).exec(format);</span><br><span class="line">      if (result) &#123;</span><br><span class="line">        format = format.replace(result[1], (result[1].length == 1) ? (option[i]) : (option[i].padStart(result[1].length, &quot;0&quot;)))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return format;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>然后在course.vue增加，在富文本内容上增加一个时间标签</p>
</li>
<li><pre><code class="vue">&lt;div class=&quot;form-group&quot;&gt;
  &lt;div class=&quot;col-lg-12&quot;&gt;
    &#123;&#123;saveContentLable&#125;&#125;
  &lt;/div&gt;
&lt;/div&gt;
//定义变量
saveContentLabel:&quot;&quot;,
//在每次打开editContent每次都要情况历史文本
 _this.saveContentLabel = &quot;&quot;;
//在saveContent中加入
if (resp.success) &#123;
    let now = Tool.dateFormat(&quot;mm:ss&quot;);
    _this.saveContentLabel = &quot;最后保存时间: &quot;+now;
&#125;		
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 7-6 课程代码优化</span><br><span class="line"></span><br><span class="line">课程自定义排序：</span><br><span class="line"></span><br><span class="line">- 注意用法：小节的顺序是可以重复的，每一章里的小节都可以从1开始排序</span><br><span class="line"></span><br><span class="line">- 首先在course.vue中进行修改</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  &lt;button v-on:click=&quot;openSortModal(course)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">    排序</span><br><span class="line">  &lt;/button&gt;&amp;nbsp;&amp;nbsp;</span><br><span class="line">  ////增加disabled</span><br><span class="line">   &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">   	&lt;label  class=&quot;col-sm-2 control-label&quot;&gt;顺序&lt;/label&gt;</span><br><span class="line">   	&lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">  		 &lt;input v-model=&quot;course.sort&quot; class=&quot;form-control&quot; disabled &gt;</span><br><span class="line">   	&lt;/div&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">  //增加模态框</span><br><span class="line">    &lt;div id=&quot;course-sort-modal&quot; class=&quot;modal fade&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;modal-header&quot;&gt;</span><br><span class="line">              &lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;</span><br><span class="line">              &lt;h4 class=&quot;modal-title&quot;&gt;排序&lt;/h4&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">              &lt;form class=&quot;form-horizontal&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                  &lt;label class=&quot;control-label col-lg-3&quot;&gt;</span><br><span class="line">                    当前排序</span><br><span class="line">                  &lt;/label&gt;</span><br><span class="line">                  &lt;div class=&quot;col-lg-9&quot;&gt;</span><br><span class="line">                    &lt;input class=&quot;form-control&quot; v-model=&quot;sort.oldSort&quot; name=&quot;oldSort&quot; disabled&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                  &lt;label class=&quot;control-label col-lg-3&quot;&gt;</span><br><span class="line">                    新排序</span><br><span class="line">                  &lt;/label&gt;</span><br><span class="line">                  &lt;div class=&quot;col-lg-9&quot;&gt;</span><br><span class="line">                    &lt;input class=&quot;form-control&quot; v-model=&quot;sort.newSort&quot; name=&quot;newSort&quot;&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/form&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">              &lt;button type=&quot;button&quot; class=&quot;btn btn-white btn-default btn-round&quot; data-dismiss=&quot;modal&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-times&quot;&gt;&lt;/i&gt;</span><br><span class="line">                取消</span><br><span class="line">              &lt;/button&gt;</span><br><span class="line">              &lt;button type=&quot;button&quot; class=&quot;btn btn-white btn-info btn-round&quot; v-on:click=&quot;updateSort()&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-plus blue&quot;&gt;&lt;/i&gt;</span><br><span class="line">                更新排序</span><br><span class="line">              &lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;&lt;!-- /.modal-content --&gt;</span><br><span class="line">        &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;</span><br><span class="line">      &lt;/div&gt;&lt;!-- /.modal --&gt;</span><br><span class="line">  //data增加变量</span><br><span class="line">   sort: &#123;</span><br><span class="line">          id: &quot;&quot;,</span><br><span class="line">          oldSort: 0,</span><br><span class="line">          newSort: 0</span><br><span class="line">        &#125;,</span><br><span class="line">  //在添加方法增加</span><br><span class="line">  _this.course = &#123;</span><br><span class="line">    sort: _this.$refs.pagination.total+1</span><br><span class="line">     &#125;;</span><br><span class="line">  //增加两个方法</span><br><span class="line">  </span><br><span class="line">      openSortModal(course) &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        _this.sort = &#123;</span><br><span class="line">          id: course.id,</span><br><span class="line">          oldSort: course.sort,</span><br><span class="line">          newSort: course.sort</span><br><span class="line">        &#125;;</span><br><span class="line">        $(&quot;#course-sort-modal&quot;).modal(&quot;show&quot;);</span><br><span class="line">      &#125;,</span><br><span class="line">  </span><br><span class="line">      /**</span><br><span class="line">       * 排序</span><br><span class="line">       */</span><br><span class="line">      updateSort() &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        if (_this.sort.newSort === _this.sort.oldSort) &#123;</span><br><span class="line">          Toast.warning(&quot;排序没有变化&quot;);</span><br><span class="line">          return;</span><br><span class="line">        &#125;</span><br><span class="line">        Loading.show();</span><br><span class="line">        _this.$ajax.post(process.env.VUE_APP_SERVER + &quot;/business/admin/course/sort&quot;, _this.sort).then((res) =&gt; &#123;</span><br><span class="line">          let response = res.data;</span><br><span class="line">  </span><br><span class="line">          if (response.success) &#123;</span><br><span class="line">            Toast.success(&quot;更新排序成功&quot;);</span><br><span class="line">            $(&quot;#course-sort-modal&quot;).modal(&quot;hide&quot;);</span><br><span class="line">            _this.list(1);</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            Toast.error(&quot;更新排序失败&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">  </span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>其次增加SortDto</p>
</li>
<li><pre><code class="java">package com.course.server.dto;

public class SortDto &#123;
    /**
     * ID
     */
    private String id;

    /**
     * 当前排序
     */
    private int oldSort;

    /**
     * 新排序
     */
    private int newSort;

    public String getId() &#123;
        return id;
    &#125;

    public void setId(String id) &#123;
        this.id = id;
    &#125;

    public int getNewSort() &#123;
        return newSort;
    &#125;

    public void setNewSort(int newSort) &#123;
        this.newSort = newSort;
    &#125;

    public int getOldSort() &#123;
        return oldSort;
    &#125;

    public void setOldSort(int oldSort) &#123;
        this.oldSort = oldSort;
    &#125;

    @Override
    public String toString() &#123;
        final StringBuffer sb = new StringBuffer(&quot;SortDto&#123;&quot;);
        sb.append(&quot;id=&#39;&quot;).append(id).append(&#39;\&#39;&#39;);
        sb.append(&quot;, oldSort=&quot;).append(oldSort);
        sb.append(&quot;, newSort=&quot;).append(newSort);
        sb.append(&#39;&#125;&#39;);
        return sb.toString();
    &#125;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 然后我们在coursecontroller添加</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  @RequestMapping(value = &quot;/sort&quot;)</span><br><span class="line">  public ResponseDto sort(@RequestBody SortDto sortDto) &#123;</span><br><span class="line">      LOG.info(&quot;更新排序&quot;);</span><br><span class="line">      ResponseDto responseDto = new ResponseDto();</span><br><span class="line">      courseService.sort(sortDto);</span><br><span class="line">      return responseDto;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>在CourseService中进行</p>
</li>
<li><pre><code class="java">//批量保存课程分类
courseCategoryService.saveBatch(course.getId(),courseDto.getCategorys());//这改了，之前是coursedto，新增课程的时候coursedto.id没有值,应该用course.id
//增加方法
/**
     * 排序
     * @param sortDto
     */
    @Transactional
    public void sort(SortDto sortDto)&#123;
        //修改当前记录的排序值
        myCourseMapper.updateSort(sortDto);

        //如果排序值变大
        if (sortDto.getNewSort()&gt;sortDto.getOldSort())&#123;
            myCourseMapper.moveSortsForward(sortDto);
        &#125;
        //如果排序值变小
        if (sortDto.getNewSort()&lt;sortDto.getOldSort())&#123;
            myCourseMapper.moveSortsBackward(sortDto);
        &#125;
    &#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 在MyCourseMapper创建CourseService调用的方法</span><br><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  int updateSort(SortDto sortDto);</span><br><span class="line">  </span><br><span class="line">  int moveSortsForward(SortDto sortDto);</span><br><span class="line">  </span><br><span class="line">  int moveSortsBackward(SortDto sortDto);</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>在MyCourseMapper.xml写对应接口</p>
</li>
<li><pre><code class="xml">&lt;update id=&quot;updateSort&quot; parameterType=&quot;com.course.server.dto.SortDto&quot;&gt;
    update course set `sort`= #&#123;newSort&#125; where id = #&#123;id&#125;
&lt;/update&gt;

&lt;update id=&quot;moveSortsBackward&quot; parameterType=&quot;com.course.server.dto.SortDto&quot;&gt;
    &lt;![CDATA[
    update course set `sort`= (`sort`+1) where `sort` &gt;= #&#123;newSort&#125; and `sort` &lt;= #&#123;oldSort&#125; and id != #&#123;id&#125;
    ]]&gt;
&lt;/update&gt;

&lt;update id=&quot;moveSortsForward&quot; parameterType=&quot;com.course.server.dto.SortDto&quot;&gt;
    &lt;![CDATA[
    update course set `sort`= (`sort`-1) where `sort` &lt;= #&#123;newSort&#125; and `sort` &gt;= #&#123;oldSort&#125; and id != #&#123;id&#125;
    ]]&gt;
&lt;/update&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">菜单隐藏掉大章和小节：</span><br><span class="line"></span><br><span class="line">- 修改一：菜单栏不出现大章管理和小节管理</span><br><span class="line"></span><br><span class="line">- 首先admin中注释掉大章和小节管理</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  &lt;!--   &lt;li class=&quot;active&quot; id=&quot;business-chapter-sidebar&quot;&gt;--&gt;</span><br><span class="line">  &lt;!--                &lt;router-link to=&quot;/business/chapter&quot;&gt;--&gt;</span><br><span class="line">  &lt;!--                  &lt;i class=&quot;menu-icon fa fa-caret-right&quot;&gt;&lt;/i&gt;--&gt;</span><br><span class="line">  &lt;!--                  大章管理--&gt;</span><br><span class="line">  &lt;!--                &lt;/router-link&gt;--&gt;</span><br><span class="line">  &lt;!--                &lt;b class=&quot;arrow&quot;&gt;&lt;/b&gt;--&gt;</span><br><span class="line">  &lt;!--              &lt;/li&gt;--&gt;</span><br><span class="line">  &lt;!--              &lt;li class=&quot;active&quot; id=&quot;business-section-sidebar&quot;&gt;--&gt;</span><br><span class="line">  &lt;!--                &lt;router-link to=&quot;/business/section&quot;&gt;--&gt;</span><br><span class="line">  &lt;!--                  &lt;i class=&quot;menu-icon fa fa-caret-right&quot;&gt;&lt;/i&gt;--&gt;</span><br><span class="line">  &lt;!--                  小节管理--&gt;</span><br><span class="line">  &lt;!--                &lt;/router-link&gt;--&gt;</span><br><span class="line">  &lt;!--                &lt;b class=&quot;arrow&quot;&gt;&lt;/b&gt;--&gt;</span><br><span class="line">  &lt;!--              &lt;/li&gt;--&gt;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>修改2：页面进入大章管理和小节管理时，侧边栏的课程管理应该显示激活样式</p>
</li>
<li><p>然后再chapter和section都加上激活样式</p>
</li>
<li><pre><code class="vue">//sidebar激活样式方法一
this.$parent.activeSidebar(&quot;business-course-sidebar&quot;);
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sessionStorage的key改成常量：</span><br><span class="line"></span><br><span class="line">- key值不要直接写字符串，后面缓存用得越来越多；key名有可能冲突，这时要改key名的话所有set和get都要改。且不要用单一的单词，最好加一些前后缀。</span><br><span class="line"></span><br><span class="line">- 在SessionStorage.js中添加常量</span><br><span class="line"></span><br><span class="line">- ```js</span><br><span class="line">  SESSION_KEY_COURSE = &quot;SESSION_KEY_COURSE&quot;; // 课程管理页面点击章管理时，保存课程信息</span><br><span class="line">  SESSION_KEY_CHAPTER = &quot;SESSION_KEY_CHAPTER&quot;; // 章管理页面点击节管理时，保存章信息</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>然后再course和chapter和section中都修改SessionStorage方法的key</p>
</li>
</ul>
<p>表格内文字上下居中：</p>
<ul>
<li><p>在static中创建css文件夹建立style.css文件，在index中引入css</p>
</li>
<li><pre><code class="css">/*表格内容上下居中显示*/
.table td&#123;
    vertical-align: middle !important;
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 7-7 讲师管理功能开发</span><br><span class="line"></span><br><span class="line">增加讲师管理功能：</span><br><span class="line"></span><br><span class="line">- 注意：菜单去掉了大章和小节，但是路由不能去</span><br><span class="line"></span><br><span class="line">- 简介要改成多行文本框textarea</span><br><span class="line"></span><br><span class="line">- all.sql增加</span><br><span class="line"></span><br><span class="line">- ```sql</span><br><span class="line">  #讲师</span><br><span class="line">  DROP TABLE IF EXISTS `teacher`;</span><br><span class="line">  create table `teacher`(</span><br><span class="line">              `id` char(8) not null default &#x27;&#x27; comment &#x27;课程id&#x27;,</span><br><span class="line">              `name` varchar(50) not null comment &#x27;名称&#x27;,</span><br><span class="line">              `nickname` varchar(50)  comment &#x27;昵称&#x27;,</span><br><span class="line">              `image` varchar(100)  comment &#x27;头像&#x27;,</span><br><span class="line">              `position` varchar(50)  comment &#x27;职位&#x27;,</span><br><span class="line">              `motto` varchar(50)  comment &#x27;座右铭&#x27;,</span><br><span class="line">              `intro` varchar(500)  comment &#x27;简介&#x27;,</span><br><span class="line">               primary key (`id`)</span><br><span class="line">  )engine =innodb default charset=utf8mb4 comment=&#x27;讲师&#x27;;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>然后就是各种代码生成器，然后admin中和router中添加相应模块和路由。</p>
</li>
</ul>
<p>讲师管理布局优化：</p>
<ul>
<li><p>只需要改teacher.vue，table删了，加上这个。</p>
</li>
<li><pre><code class="vue">&lt;div class=&quot;row&quot;&gt;
  &lt;div v-for=&quot;teacher in teachers&quot; class=&quot;col-md-3&quot;&gt;
    &lt;div&gt;
      &lt;span class=&quot;profile-picture&quot;&gt;
        &lt;img v-show=&quot;!teacher.image&quot; class=&quot;editable img-responsive editable-click editable-empty&quot; src=&quot;/static/image/讲师头像/头像1.jpg&quot; v-bind:title=&quot;teacher.intro&quot;/&gt;
        &lt;img v-show=&quot;teacher.image&quot; class=&quot;editable img-responsive editable-click editable-empty&quot; v-bind:src=&quot;teacher.image&quot; v-bind:title=&quot;teacher.intro&quot;/&gt;
      &lt;/span&gt;

      &lt;div class=&quot;space-4&quot;&gt;&lt;/div&gt;

      &lt;div class=&quot;width-85 label label-info label-xlg arrowed-in arrowed-in-right&quot;&gt;
        &lt;div class=&quot;inline position-relative&quot;&gt;
          &lt;a href=&quot;javascript:;&quot; class=&quot;user-title-label dropdown-toggle&quot; data-toggle=&quot;dropdown&quot;&gt;
            &lt;i class=&quot;ace-icon fa fa-circle light-green&quot;&gt;&lt;/i&gt;
            &amp;nbsp;
            &lt;span class=&quot;white&quot;&gt;&#123;&#123;teacher.position&#125;&#125;&lt;/span&gt;
          &lt;/a&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class=&quot;space-6&quot;&gt;&lt;/div&gt;

    &lt;div class=&quot;text-center&quot;&gt;
      &lt;a href=&quot;javascript:;&quot; class=&quot;text-info bigger-110&quot; v-bind:title=&quot;teacher.motto&quot;&gt;
        &lt;i class=&quot;ace-icon fa fa-user&quot;&gt;&lt;/i&gt;
        &#123;&#123;teacher.name&#125;&#125;【&#123;&#123;teacher.nickname&#125;&#125;】
      &lt;/a&gt;
    &lt;/div&gt;

    &lt;div class=&quot;space-6&quot;&gt;&lt;/div&gt;

    &lt;div class=&quot;profile-social-links align-center&quot;&gt;
      &lt;button v-on:click=&quot;edit(teacher)&quot; class=&quot;btn btn-xs btn-info&quot;&gt;
        &lt;i class=&quot;ace-icon fa fa-pencil bigger-120&quot;&gt;&lt;/i&gt;
      &lt;/button&gt;
      &amp;nbsp;
      &lt;button v-on:click=&quot;del(teacher.id)&quot; class=&quot;btn btn-xs btn-danger&quot;&gt;
        &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;div class=&quot;hr hr16 dotted&quot;&gt;&lt;/div&gt;

  &lt;/div&gt;
&lt;/div&gt;
//再把简介的input修改
&lt;textarea v-model=&quot;teacher.intro&quot; class=&quot;form-control&quot; rows=&quot;5&quot;&gt;&lt;/textarea&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">课程讲师的关联：</span><br><span class="line"></span><br><span class="line">- 一个分类可以有多门课程，一门课程也可以属于多个分类，所以他们是多对多的关系。多对多的关系，一般会设计个中间来维护关系</span><br><span class="line"></span><br><span class="line">- 一个讲师可以讲多门课程，一门课程只能有一个讲师，所以他们是一对多的关系。一对多的关系，可以把关系维护在“一那张表中</span><br><span class="line"></span><br><span class="line">- 旧表加字段，使用单独的sql：alter table，这样，上生产的时候也是执行这个sql</span><br><span class="line"></span><br><span class="line">- ```sql</span><br><span class="line">  alter table `course` add column (`teacher_id` char(8) comment  &#x27;讲师|teacher.id&#x27;);</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>需要重新生成mybatis-generator。增加字段重新生成代码时，CourseMapper.java不会变化。</p>
</li>
<li><p>要求：mybatis自动生成的四个文件不允许修改，这样才能做到重复生成</p>
</li>
<li><p>但是courseDto要手动添加course.java中新增加的变量</p>
</li>
<li><p>在course.vue中修改代码</p>
</li>
<li><pre><code>//在data中增加
teachers: [],//页面打开始就加载所有讲师
//在mounted中增加
 _this.allTeacher();
//增加方法
allTeacher() &#123;
  let _this = this;
  Loading.show();
  _this.$ajax.post(process.env.VUE_APP_SERVER + &#39;/business/admin/teacher/all&#39;).then((respond) =&gt; &#123;
    Loading.hide();
    let resp = respond.data;
    _this.teachers = resp.content;

  &#125;)
&#125;,
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 在后端增加all方法，加载所有讲师信息。参照CategoryController的all来修改TeacherController。同样service也一样。</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">/**</span><br><span class="line"> * 列表查询</span><br><span class="line"> */</span><br><span class="line">@PostMapping(&quot;/all&quot;)</span><br><span class="line">public ResponseDto all()&#123;</span><br><span class="line">    ResponseDto responseDto = new ResponseDto();</span><br><span class="line">    List&lt;TeacherDto&gt; teacherDtoList = teacherService.all();</span><br><span class="line">    responseDto.setContent(teacherDtoList);</span><br><span class="line">    return responseDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>在课程表单中增加讲师选择框，在course.vue</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">  &lt;label  class=&quot;col-sm-2 control-label&quot;&gt;讲师&lt;/label&gt;</span><br><span class="line">  &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">    &lt;select v-model=&quot;course.teacherId&quot; class=&quot;form-control&quot;  &gt;</span><br><span class="line">      &lt;option v-for=&quot;o in teachers&quot; v-bind:value=&quot;o.id&quot;&gt;&#123;&#123;o.name&#125;&#125;&lt;/option&gt;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>课程列表中显示讲师信息，课程名字字体自适应：</p>
<ul>
<li><p>v-for中，对循环的数组，可通过filter进行数据过滤</p>
</li>
<li><pre><code class="vue">&lt;div v-for=&quot;teacher in teachers.filter(t=&gt;&#123;return t.id===course.teacherId&#125;)&quot; class=&quot;profile-activity clearfix&quot;&gt;
  &lt;div&gt;
    &lt;img v-show=&quot;!teacher.image&quot; class=&quot;pull-left&quot; src=&quot;/ace/assets/images/avatars/avatar5.png&quot;&gt;
    &lt;img v-show=&quot;teacher.image&quot; class=&quot;pull-left&quot; v-bind:src=&quot;teacher.image&quot;&gt;
    &lt;a class=&quot;user&quot; href=&quot;#&quot;&gt; &#123;&#123;teacher.name&#125;&#125; &lt;/a&gt;
    &lt;br&gt;
    &#123;&#123;teacher.position&#125;&#125;
  &lt;/div&gt;
&lt;/div&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 字体大小自适应，根据屏幕的分辩率显示不同大小的字体</span><br><span class="line"></span><br><span class="line">- ```vue</span><br><span class="line">  @media (max-width: 1199px) &#123;</span><br><span class="line">    .caption h3 &#123;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p>前端开发小技巧：可以用浏览器的开发工具修改样式，调试好后，再把样式拷到代码里</p>
</li>
</ul>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：Spring Cloud + Vue 前后端分离2-2</li>
        <li>Post author：Fang</li>
        <li>Create time：2022-02-15 08:36:23</li>
        <li>
            Post link：https://ainianxu.github.io/2022/02/15/Spring Cloud + Vue 前后端分离 2-2/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE/">#完整项目</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/02/20/Spring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%203-1/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Spring Cloud + Vue 前后端分离3-1</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/02/07/Spring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%202-1/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Spring Cloud + Vue 前后端分离2-1</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;Comments</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'loa9BVbgmyFLwBMHhg1Cycx1-gzGzoHsz',
                    appKey: '47pIz6ewIXRi5251WyfUpQOB',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '😜 尽情吐槽吧~',
                    lang: 'en'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = 'Fang';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2021</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Fang</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.4</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC7%E7%AB%A0-%E6%A0%B8%E5%BF%83%E4%B8%9A%E5%8A%A1%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91"><span class="nav-number">1.</span> <span class="nav-text">第7章 核心业务功能开发</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-%E8%AF%BE%E7%A8%8B%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91-%E8%AF%BE%E7%A8%8B%E5%A4%A7%E7%AB%A0%E5%B0%8F%E8%8A%82%E5%85%B3%E8%81%94"><span class="nav-number">1.1.</span> <span class="nav-text">7-1 课程管理功能开发-课程大章小节关联</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-%E8%AF%BE%E7%A8%8B%E6%97%B6%E9%95%BF%E7%9A%84%E4%BF%9D%E5%AD%98%E5%92%8C%E6%98%BE%E7%A4%BA"><span class="nav-number">1.2.</span> <span class="nav-text">7-2 课程时长的保存和显示</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%E7%9A%84%E5%BC%80%E5%8F%91"><span class="nav-number">1.3.</span> <span class="nav-text">7-3 分类管理功能的开发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-%E8%AF%BE%E7%A8%8B%E5%92%8C%E5%88%86%E7%B1%BB%E5%85%B3%E8%81%94%E4%BF%9D%E5%AD%98%E5%92%8C%E6%98%BE%E7%A4%BA"><span class="nav-number">1.4.</span> <span class="nav-text">7-4 课程和分类关联保存和显示</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.4/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
