<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>完整项目之Spring Cloud + Vue 前后端分离2-2 | Hexo</title><meta name="keywords" content="完整项目"><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第7章 核心业务功能开发7-1 课程管理功能开发-课程大章小节关联本章将演示核心业务功能开发，包括课程、章、节、分类的管理功能，学习前端页面跳转及参数传递，Vue过滤器，前端树形展示插件zTree，富文本框的使用，Spring事务，通用排序功能解决方案等。  课程管理页面美化：1.课程管理页面美化  scoped：style下的样式只应用于当前组件，防止互相污染  只是修改前端，然后将table标">
<meta property="og:type" content="article">
<meta property="og:title" content="完整项目之Spring Cloud + Vue 前后端分离2-2">
<meta property="og:url" content="http://example.com/2022/02/15/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%202-2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="第7章 核心业务功能开发7-1 课程管理功能开发-课程大章小节关联本章将演示核心业务功能开发，包括课程、章、节、分类的管理功能，学习前端页面跳转及参数传递，Vue过滤器，前端树形展示插件zTree，富文本框的使用，Spring事务，通用排序功能解决方案等。  课程管理页面美化：1.课程管理页面美化  scoped：style下的样式只应用于当前组件，防止互相污染  只是修改前端，然后将table标">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2022-02-15T00:36:23.000Z">
<meta property="article:modified_time" content="2022-05-11T06:46:16.901Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="完整项目">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2022/02/15/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%202-2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '完整项目之Spring Cloud + Vue 前后端分离2-2',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-11 14:46:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">307</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Hexo</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">完整项目之Spring Cloud + Vue 前后端分离2-2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-02-15T00:36:23.000Z" title="Created 2022-02-15 08:36:23">2022-02-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-05-11T06:46:16.901Z" title="Updated 2022-05-11 14:46:16">2022-05-11</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="完整项目之Spring Cloud + Vue 前后端分离2-2"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="第7章-核心业务功能开发"><a href="#第7章-核心业务功能开发" class="headerlink" title="第7章 核心业务功能开发"></a>第7章 核心业务功能开发</h1><h2 id="7-1-课程管理功能开发-课程大章小节关联"><a href="#7-1-课程管理功能开发-课程大章小节关联" class="headerlink" title="7-1 课程管理功能开发-课程大章小节关联"></a>7-1 课程管理功能开发-课程大章小节关联</h2><p>本章将演示核心业务功能开发，包括课程、章、节、分类的管理功能，学习前端页面跳转及参数传递，Vue过滤器，前端树形展示插件zTree，富文本框的使用，Spring事务，通用排序功能解决方案等。</p>
<hr>
<p>课程管理页面美化：1.课程管理页面美化</p>
<ul>
<li><p>scoped：style下的样式只应用于当前组件，防止互相污染</p>
</li>
<li><p>只是修改前端，然后将table标签注释</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;row&quot;&gt;</span><br><span class="line">  &lt;div v-for=&quot;course in courses&quot; class=&quot;col-md-4&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;thumbnail search-thumbnail&quot;&gt;</span><br><span class="line">      &lt;img v-show=&quot;!course.image&quot; class=&quot;media-object&quot; src=&quot;/static/image/demo-course.jpg&quot; /&gt;</span><br><span class="line">      &lt;img v-show=&quot;course.image&quot; class=&quot;media-object&quot; v-bind:src=&quot;course.image&quot; /&gt;</span><br><span class="line">      &lt;div class=&quot;caption&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;clearfix&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;pull-right label label-primary info-label&quot;&gt;&#123;&#123;COURSE_LEVEL|option..KV(course.level)&#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;span class=&quot;pull-right label label-primary info-label&quot;&gt;&#123;&#123;COURSE_CHARGE|option..KV(course.charge)&#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;span class=&quot;pull-right label label-primary info-label&quot;&gt;&#123;&#123;COURSE_STATUS|option..KV(course.status)&#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;h3 class=&quot;search-title&quot;&gt;</span><br><span class="line">          &lt;a href=&quot;#&quot; class=&quot;blue&quot;&gt;&#123;&#123; course.name&#125;&#125;&lt;/a&gt;</span><br><span class="line">        &lt;/h3&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          &lt;span class=&quot;blue bolder bigger-150&quot;&gt;&#123;&#123;course.price&#125;&#125;&amp;nbsp;&lt;i class=&quot;fa fa-rmb&quot;&gt;&lt;/i&gt;&lt;/span&gt;&amp;nbsp;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; course.summary&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          &lt;span class=&quot;badge badge-info&quot;&gt;&#123;&#123;course.id&#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;span class=&quot;badge badge-info&quot;&gt;排序：&#123;&#123;course.sort&#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;span class=&quot;badge badge-info&quot;&gt;时长：&#123;&#123;course.time&#125;&#125;&lt;/span&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          &lt;button v-on:click=&quot;edit(course)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">            编辑</span><br><span class="line">          &lt;/button&gt;&amp;nbsp;</span><br><span class="line">          &lt;button v-on:click=&quot;del(course.id)&quot; class=&quot;btn btn-white btn-xs btn-warning btn-round&quot;&gt;</span><br><span class="line">            删除</span><br><span class="line">          &lt;/button&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .caption h3&#123;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>课程管理和大章管理互相跳转</p>
<ul>
<li><p>完成功能：在课程列表中增加“大章”按钮，点击会跳转到大章页面，并且筛选出当前课程下所有的大章。大章页面增加显示课程名称，并且有可以返回课程管理页面。</p>
</li>
<li><p>sessionStorage是会话缓存，浏览器窗口关闭，缓存就没了。localStorage是本地缓存，浏览器关闭后，下次再打开还能读到。sessionStorage和localStorage只能操作字符串，但是我们经常要放对象数据，所以封装一下。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">SessionStorage</span> = &#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params">key</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> v = sessionStorage.<span class="title function_">getItem</span>(key);</span><br><span class="line">        <span class="keyword">if</span> (v &amp;&amp; <span class="title function_">typeof</span>(v) !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; v !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">set</span>: <span class="keyword">function</span> (<span class="params">key, data</span>) &#123;</span><br><span class="line">        sessionStorage.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">remove</span>: <span class="keyword">function</span> (<span class="params">key</span>) &#123;</span><br><span class="line">        sessionStorage.<span class="title function_">removeItem</span>(key);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">clearAll</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        sessionStorage.<span class="title function_">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">LocalStorage</span> = &#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params">key</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> v = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">        <span class="keyword">if</span> (v &amp;&amp; <span class="title function_">typeof</span>(v) !== <span class="string">&quot;undefined&quot;</span> &amp;&amp; v !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">set</span>: <span class="keyword">function</span> (<span class="params">key, data</span>) &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">remove</span>: <span class="keyword">function</span> (<span class="params">key</span>) &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(key);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">clearAll</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>首先再index.html增加引用</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  h5缓存  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;static/js/session-storage.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;static/js/local-storage.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>然后再course.vue增加一个大章按钮进行跳转</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;button v-on:click=&quot;toChapter(course)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">        大章</span><br><span class="line">&lt;/button&gt;&amp;nbsp;</span><br><span class="line">//增加toChapter方法</span><br><span class="line">toChapter(course) &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      SessionStorage.set(&quot;course&quot;,course);</span><br><span class="line">      _this.$router.push(&quot;/business/chapter&quot;);</span><br><span class="line">   &#125;,</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<ul>
<li><p>组件（页面）间传输数据可以用h5原生的localStorage或sessionStorage；也可以用js全局变量，也可以用vuex store。但是后两者会在页面刷新时丢失数据，所以推荐使用h5原生的。</p>
</li>
<li><p>接下来再chapter.vue的mounted里将SessionStorage的缓存取出来</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> data: function () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      chapter: &#123;&#125;,</span><br><span class="line">      chapters: [],</span><br><span class="line">      course:&#123;&#125;,//一定要加</span><br><span class="line">    &#125;</span><br><span class="line">mounted: function () &#123;</span><br><span class="line">  let _this = this;</span><br><span class="line">  _this.$refs.pagination.size = 5;</span><br><span class="line">  let course = SessionStorage.get(&quot;course&quot;)||&#123;&#125;;</span><br><span class="line">  if (Tool.isEmpty(course))&#123;</span><br><span class="line">    _this.$router.push(&quot;/welcome&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  _this.course =course;</span><br><span class="line">  _this.list(1);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li>简单的跳转可以用router-link，如过有其他操作，可以写个click方法。比如前面完成的，从课程跳到大章，需要先缓存课程信息，所以写click方法</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;h3&gt;&#123;&#123;course.name&#125;&#125;&lt;/h3&gt;</span><br><span class="line">/////////////////////////////////////////////////////////</span><br><span class="line">  &lt;router-link to=&quot;/business/course&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;</span><br><span class="line">    &lt;i class=&quot;ace-icon fa fa-arrow-left red2&quot;&gt;&lt;/i&gt;</span><br><span class="line">    返回课程</span><br><span class="line">  &lt;/router-link&gt;</span><br></pre></td></tr></table></figure>

<p>大章管理保存和查询功能关联courseId</p>
<ul>
<li>改下chapter，将表单的courseID改成这个</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                &lt;label  class=&quot;col-sm-2 control-label&quot;&gt;课程&lt;/label&gt;</span><br><span class="line">                &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">                  &lt;P class=&quot;form-control-static&quot;&gt;&#123;&#123;course.name&#125;&#125;&lt;/P&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">//////////////////////////</span><br><span class="line">// save的保存校验</span><br><span class="line">      if (!Validator.require(_this.chapter.name, &quot;名称&quot;)</span><br><span class="line">          || !Validator.length(_this.chapter.courseId, &quot;课程ID&quot;, 1, 8)) &#123;</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">      _this.chapter.courseId =_this.course.id;</span><br><span class="line">////////////////////////////////////////////////</span><br><span class="line">list(page) &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      Loading.show();</span><br><span class="line">      _this.$ajax.post(process.env.VUE_APP_SERVER +&#x27;/business/admin/chapter/list&#x27;, &#123;</span><br><span class="line">        page: page,</span><br><span class="line">        size: _this.$refs.pagination.size,</span><br><span class="line">        courseId:_this.course.id//根据传进来的课程ID来筛选所有的章</span><br></pre></td></tr></table></figure>

<ul>
<li>首先再server的dto增加ChapterPageDto</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.course.server.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChapterPageDto</span> <span class="keyword">extends</span> <span class="title class_">PageDto</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String courseId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCourseId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> courseId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCourseId</span><span class="params">(String courseId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.courseId = courseId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(<span class="string">&quot;ChapterPageDto&#123;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;courseId=&#x27;&quot;</span>).append(courseId).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;, page=&quot;</span>).append(page);</span><br><span class="line">        sb.append(<span class="string">&quot;, size=&quot;</span>).append(size);</span><br><span class="line">        sb.append(<span class="string">&quot;, total=&quot;</span>).append(total);</span><br><span class="line">        sb.append(<span class="string">&quot;, list=&quot;</span>).append(list);</span><br><span class="line">        sb.append(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>接着转到chaptercontroller</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 列表查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseDto <span class="title function_">list</span><span class="params">(<span class="meta">@RequestBody</span> ChapterPageDto chapterPageDto)</span>&#123;</span><br><span class="line">    <span class="type">ResponseDto</span> <span class="variable">responseDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseDto</span>();</span><br><span class="line">    ValidatorUtil.require(chapterPageDto.getCourseId(), <span class="string">&quot;课程ID&quot;</span>);</span><br><span class="line">    chapterService.list(chapterPageDto);</span><br><span class="line">    responseDto.setContent(chapterPageDto);</span><br><span class="line">    <span class="keyword">return</span> responseDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>然后ChapterService</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 列表查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">list</span><span class="params">(ChapterPageDto chapterPageDto)</span> &#123;</span><br><span class="line">    PageHelper.startPage(chapterPageDto.getPage(), chapterPageDto.getSize());</span><br><span class="line">    <span class="type">ChapterExample</span> <span class="variable">chapterExample</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChapterExample</span>();</span><br><span class="line">    ChapterExample.<span class="type">Criteria</span> <span class="variable">criteria</span> <span class="operator">=</span> chapterExample.createCriteria();</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(chapterPageDto.getCourseId())) &#123;</span><br><span class="line">        criteria.andCourseIdEqualTo(chapterPageDto.getCourseId());</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Chapter&gt; chapterList = chapterMapper.selectByExample(chapterExample);</span><br><span class="line">    PageInfo&lt;Chapter&gt; pageInfo = <span class="keyword">new</span> <span class="title class_">PageInfo</span>&lt;&gt;(chapterList);</span><br><span class="line">    chapterPageDto.setTotal(pageInfo.getTotal());</span><br><span class="line">    List&lt;ChapterDto&gt; chapterDtoList = CopyUtil.copyList(chapterList, ChapterDto.class);</span><br><span class="line">    chapterPageDto.setList(chapterDtoList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>经验分享：service层的查询条件写的松一点，灵活一点。service层可能被多个controller调用，也可能被其他service调用，每个调用的查询条件可能不一样</li>
</ul>
<p>大章管理和小节管理互相跳转：小节管理保存和查询功能关联courseId，chapterId</p>
<ul>
<li>对chapter做修改</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;h4 class=&quot;lighter&quot;&gt;</span><br><span class="line">  &lt;i class=&quot;ace-icon fa fa-hand-o-right icon-animated-hand-pointer blue&quot;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;router-link to=&quot;/business/course&quot; class=&quot;pink&quot;&gt; &#123;&#123;course.name&#125;&#125; &lt;/router-link&gt;</span><br><span class="line">&lt;/h4&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">////////////////////////////////////////</span><br><span class="line">&lt;div class=&quot;hidden-sm hidden-xs btn-group&quot;&gt;</span><br><span class="line">    &lt;button v-on:click=&quot;toSection(chapter)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">        小节</span><br><span class="line">    &lt;/button&gt;&amp;nbsp;</span><br><span class="line">    &lt;button v-on:click=&quot;edit(chapter)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">        编辑</span><br><span class="line">    &lt;/button&gt;&amp;nbsp;</span><br><span class="line">    &lt;button v-on:click=&quot;del(chapter.id)&quot; class=&quot;btn btn-white btn-xs btn-warning btn-round&quot;&gt;</span><br><span class="line">        删除</span><br><span class="line">    &lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">/////////////////////////////////////////////</span><br><span class="line">toSection(chapter) &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      SessionStorage.set(&quot;chapter&quot;, chapter);</span><br><span class="line">      _this.$router.push(&quot;/business/section&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>然后对section</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;h4 class=&quot;lighter&quot;&gt;</span><br><span class="line">  &lt;i class=&quot;ace-icon fa fa-hand-o-right icon-animated-hand-pointer blue&quot;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;router-link to=&quot;/business/course&quot; class=&quot;pink&quot;&gt; &#123;&#123;course.name&#125;&#125; &lt;/router-link&gt;：</span><br><span class="line">  &lt;i class=&quot;ace-icon fa fa-hand-o-right icon-animated-hand-pointer blue&quot;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;router-link to=&quot;/business/chapter&quot; class=&quot;pink&quot;&gt; &#123;&#123;chapter.name&#125;&#125; &lt;/router-link&gt;</span><br><span class="line">&lt;/h4&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">///////////////////////////////////表单</span><br><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">    &lt;label  class=&quot;col-sm-2 control-label&quot;&gt;课程&lt;/label&gt;</span><br><span class="line">    &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">        &lt;p class=&quot;form-control-static&quot;&gt;&#123;&#123;course.name&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">    &lt;label  class=&quot;col-sm-2 control-label&quot;&gt;大章&lt;/label&gt;</span><br><span class="line">    &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">        &lt;p class=&quot;form-control-static&quot;&gt;&#123;&#123;chapter.name&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">////////////////////////////////////////////</span><br><span class="line"> data: function () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      section: &#123;&#125;,</span><br><span class="line">      sections: [],</span><br><span class="line">      SECTION_CHARGE: SECTION_CHARGE,</span><br><span class="line">      course:&#123;&#125;,//这</span><br><span class="line">      chapter:&#123;&#125;,//这</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted: function () &#123;</span><br><span class="line">    let _this = this;</span><br><span class="line">    _this.$refs.pagination.size = 5;</span><br><span class="line">    let course = SessionStorage.get(&quot;course&quot;) || &#123;&#125;;</span><br><span class="line">    let chapter = SessionStorage.get(&quot;chapter&quot;) || &#123;&#125;;</span><br><span class="line">   </span><br><span class="line">    if (Tool.isEmpty(course) || Tool.isEmpty(chapter)) &#123;</span><br><span class="line">      _this.$router.push(&quot;/welcome&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    _this.course = course;</span><br><span class="line">    _this.chapter = chapter;</span><br><span class="line">    _this.list(1);</span><br><span class="line">  &#125;,</span><br><span class="line">//////////////////////////////////////////////////列表查询两个参数</span><br><span class="line">courseId: _this.course.id,</span><br><span class="line">chapterId: _this.chapter.id</span><br><span class="line">////////////////////////////////////////////////////保存给两个赋值</span><br><span class="line">_this.section.courseId = _this.course.id;</span><br><span class="line">_this.section.chapterId = _this.chapter.id;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>增加SectionPageDto</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.course.server.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SectionPageDto</span> <span class="keyword">extends</span> <span class="title class_">PageDto</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String courseId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String chapterId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCourseId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> courseId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCourseId</span><span class="params">(String courseId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.courseId = courseId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getChapterId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> chapterId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChapterId</span><span class="params">(String chapterId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.chapterId = chapterId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(<span class="string">&quot;SectionPageDto&#123;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;courseId=&#x27;&quot;</span>).append(courseId).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;, chapterId=&#x27;&quot;</span>).append(chapterId).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;, page=&quot;</span>).append(page);</span><br><span class="line">        sb.append(<span class="string">&quot;, size=&quot;</span>).append(size);</span><br><span class="line">        sb.append(<span class="string">&quot;, total=&quot;</span>).append(total);</span><br><span class="line">        sb.append(<span class="string">&quot;, list=&quot;</span>).append(list);</span><br><span class="line">        sb.append(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>然后对SectionController修改</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 列表查询</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseDto <span class="title function_">list</span><span class="params">(<span class="meta">@RequestBody</span> SectionPageDto sectionPageDto)</span>&#123;</span><br><span class="line">    <span class="type">ResponseDto</span> <span class="variable">responseDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseDto</span>();</span><br><span class="line">    ValidatorUtil.require(sectionPageDto.getCourseId(), <span class="string">&quot;课程ID&quot;</span>);</span><br><span class="line">    ValidatorUtil.require(sectionPageDto.getChapterId(), <span class="string">&quot;大章ID&quot;</span>);</span><br><span class="line">    sectionService.list(sectionPageDto);</span><br><span class="line">    responseDto.setContent(sectionPageDto);</span><br><span class="line">    <span class="keyword">return</span> responseDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>最后对SectionService，criteria相当于写where语句</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 列表查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">list</span><span class="params">(SectionPageDto sectionPageDto)</span>&#123;</span><br><span class="line">    PageHelper.startPage(sectionPageDto.getPage(),sectionPageDto.getSize());</span><br><span class="line">    <span class="type">SectionExample</span> <span class="variable">sectionExample</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SectionExample</span>();</span><br><span class="line">    SectionExample.<span class="type">Criteria</span> <span class="variable">criteria</span> <span class="operator">=</span> sectionExample.createCriteria();</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(sectionPageDto.getCourseId())) &#123;</span><br><span class="line">        criteria.andCourseIdEqualTo(sectionPageDto.getCourseId());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(sectionPageDto.getChapterId())) &#123;</span><br><span class="line">        criteria.andChapterIdEqualTo(sectionPageDto.getChapterId());</span><br><span class="line">    &#125;</span><br><span class="line">    sectionExample.setOrderByClause(<span class="string">&quot;sort asc&quot;</span>);</span><br><span class="line">    List&lt;Section&gt; sectionList = sectionMapper.selectByExample(sectionExample);</span><br><span class="line">    PageInfo&lt;Section&gt; pageInfo =<span class="keyword">new</span> <span class="title class_">PageInfo</span>&lt;&gt;(sectionList);</span><br><span class="line">    sectionPageDto.setTotal(pageInfo.getTotal());</span><br><span class="line">    ArrayList&lt;SectionDto&gt; sectionDtoArrayList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;SectionDto&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, l=sectionList.size(); i &lt;l ; i++) &#123;</span><br><span class="line">        <span class="type">Section</span> <span class="variable">section</span> <span class="operator">=</span> sectionList.get(i);</span><br><span class="line">        <span class="type">SectionDto</span> <span class="variable">sectionDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SectionDto</span>();</span><br><span class="line">        BeanUtils.copyProperties(section,sectionDto);</span><br><span class="line">        sectionDtoArrayList.add(sectionDto);</span><br><span class="line">    &#125;</span><br><span class="line">    sectionPageDto.setList(sectionDtoArrayList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-2-课程时长的保存和显示"><a href="#7-2-课程时长的保存和显示" class="headerlink" title="7-2 课程时长的保存和显示"></a>7-2 课程时长的保存和显示</h2><p>保存节时，更新课程总时长</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.保存节时，更新课程总时长</span><br><span class="line">2.增加自定义mapper</span><br></pre></td></tr></table></figure>

<ul>
<li>自定义的xml要和自动生成的xml分开，所以再server的mapper中都增加两个文件夹my一个存入MyCourseMapper.java，一个MyCourseMapper.xml</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.course.server.mapper.my;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyCourseMapper</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">updateTime</span><span class="params">(<span class="meta">@Param(&quot;courseId&quot;)</span> String courseId)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.course.server.mapper.my.MyCourseMapper&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateTime&quot;</span>&gt;</span></span><br><span class="line">        update course c set `time` = (select sum(`time`) from `section` where course_id = #&#123;courseId&#125;)</span><br><span class="line">        where c.id = #&#123;courseId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>代码规范提示SectionService不要直接调用course的mapper，而是调用平级的CourseService。这时就需要将MyCourseMapper在CourseService封装一下</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">LOG</span> <span class="operator">=</span> LoggerFactory.getLogger(CourseService.class);</span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> MyCourseMapper myCourseMapper;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 更新课程时长</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> courseId</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateTime</span><span class="params">(String courseId)</span> &#123;</span><br><span class="line">	LOG.info(<span class="string">&quot;更新课程时长：&#123;&#125;&quot;</span>, courseId);</span><br><span class="line">	myCourseMapper.updateTime(courseId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在SectionService使用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> CourseService courseService;</span><br><span class="line">在保存中添加</span><br><span class="line">courseService.updateTime(sectionDto.getCourseId());</span><br></pre></td></tr></table></figure>

<ul>
<li>因为我们在mapper下新增个文件夹所以application.properties也要改</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis.mapper-locations</span>=<span class="string">classpath:/mapper/**/*.xml</span></span><br></pre></td></tr></table></figure>

<p>增加事务处理：</p>
<ul>
<li><p>一次操作会更新或修改多张表，一般为了保证数据一致，需要增加事务处理</p>
</li>
<li><p>在server的config增加TransactionManagementConfig</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.course.server.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransactionManagementConfig</span> &#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>使用时只需要在你想使用的方法上加@Transactional</p>
</li>
<li><p>数据保存进数据库了，说明事务没有回滚，事务不起作用</p>
</li>
<li><p>自定义异常一般可以选择继承RuntimeException。</p>
</li>
<li><p>同一个类的内部方法互相调用，methodA调用methodB，methodB事务不起作用。Spring的事务处理是利用AOP生成动态代理类，内部方法调用时不经过代理类，所以事务不生效</p>
</li>
</ul>
<p>增加时长格式化filter：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.增加时长格式化filter format..Second</span><br></pre></td></tr></table></figure>

<ul>
<li>在filter增加</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 时长格式化</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> value 例如：36000</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">string</span>&#125; 例如：10:00:00</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> format..<span class="property">Second</span> = <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    value = value || <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> second = <span class="built_in">parseInt</span>(value, <span class="number">10</span>); <span class="comment">// 秒</span></span><br><span class="line">    <span class="keyword">let</span> minute = <span class="number">0</span>; <span class="comment">// 分</span></span><br><span class="line">    <span class="keyword">let</span> hour = <span class="number">0</span>; <span class="comment">// 小时</span></span><br><span class="line">    <span class="keyword">if</span> (second &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">        <span class="comment">// 当大于60秒时，才需要做转换</span></span><br><span class="line">        minute = <span class="title class_">Math</span>.<span class="title function_">floor</span>(second / <span class="number">60</span>);</span><br><span class="line">        second = <span class="title class_">Math</span>.<span class="title function_">floor</span>(second % <span class="number">60</span>);</span><br><span class="line">        <span class="keyword">if</span> (minute &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">            hour = <span class="title class_">Math</span>.<span class="title function_">floor</span>(minute / <span class="number">60</span>);</span><br><span class="line">            minute = <span class="title class_">Math</span>.<span class="title function_">floor</span>(minute % <span class="number">60</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 小于60秒时，直接显示，不需要处理</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="string">&quot;&quot;</span> + <span class="title class_">PrefixInteger</span>(second, <span class="number">2</span>) + <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">// 拼上分钟</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span> + <span class="title class_">PrefixInteger</span>(minute, <span class="number">2</span>) + <span class="string">&quot;:&quot;</span> + result;</span><br><span class="line">    <span class="comment">// 拼上小时</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span> + <span class="title class_">PrefixInteger</span>(hour, <span class="number">2</span>) + <span class="string">&quot;:&quot;</span> + result;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 格式化指定长度，前面补0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">PrefixInteger</span>(<span class="params">num, length</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="title class_">Array</span>(length).<span class="title function_">join</span>(<span class="string">&#x27;0&#x27;</span>) + num).<span class="title function_">slice</span>(-length);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    option..<span class="property">KV</span>,</span><br><span class="line">    format..<span class="property">Second</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用的时候直接在时间后加过滤器</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;两个大括号包住section.time | format..Second&lt;/td&gt;</span><br></pre></td></tr></table></figure>

<h2 id="7-3-分类管理功能的开发"><a href="#7-3-分类管理功能的开发" class="headerlink" title="7-3 分类管理功能的开发"></a>7-3 分类管理功能的开发</h2><p>分类表设计和基本代码生成：</p>
<ul>
<li>首先设计数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># 分类</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `category`;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> `category`</span><br><span class="line">(</span><br><span class="line">    `id`         <span class="type">CHAR</span>(<span class="number">8</span>)     <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">    `parent`         <span class="type">CHAR</span>(<span class="number">8</span>)     <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;父id&#x27;</span>,</span><br><span class="line">    `name`      <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;名称&#x27;</span>,</span><br><span class="line">    `sort`       <span class="type">INT</span> COMMENT <span class="string">&#x27;顺序&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">   )engine <span class="operator">=</span>innodb <span class="keyword">default</span> charset<span class="operator">=</span>utf8mb4 comment<span class="operator">=</span><span class="string">&#x27;分类&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;前端技术&#x27;</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000101&#x27;</span>,<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;html/css&#x27;</span>,<span class="number">101</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000102&#x27;</span>,<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;javascript&#x27;</span>,<span class="number">102</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000103&#x27;</span>,<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;vue.js&#x27;</span>,<span class="number">103</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000104&#x27;</span>,<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;react.js&#x27;</span>,<span class="number">104</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000105&#x27;</span>,<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;angular&#x27;</span>,<span class="number">105</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000106&#x27;</span>,<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;node.js&#x27;</span>,<span class="number">106</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000107&#x27;</span>,<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;jquery&#x27;</span>,<span class="number">107</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000108&#x27;</span>,<span class="string">&#x27;00000100&#x27;</span>,<span class="string">&#x27;小程序&#x27;</span>,<span class="number">108</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000200&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;后端技术&#x27;</span>,<span class="number">200</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000201&#x27;</span>,<span class="string">&#x27;00000200&#x27;</span>,<span class="string">&#x27;java&#x27;</span>,<span class="number">201</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000202&#x27;</span>,<span class="string">&#x27;00000200&#x27;</span>,<span class="string">&#x27;springboot&#x27;</span>,<span class="number">202</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000203&#x27;</span>,<span class="string">&#x27;00000200&#x27;</span>,<span class="string">&#x27;spring cloud&#x27;</span>,<span class="number">203</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000204&#x27;</span>,<span class="string">&#x27;00000200&#x27;</span>,<span class="string">&#x27;ssm&#x27;</span>,<span class="number">204</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000205&#x27;</span>,<span class="string">&#x27;00000200&#x27;</span>,<span class="string">&#x27;python&#x27;</span>,<span class="number">205</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000206&#x27;</span>,<span class="string">&#x27;00000200&#x27;</span>,<span class="string">&#x27;爬虫&#x27;</span>,<span class="number">206</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000300&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;移动开发&#x27;</span>,<span class="number">300</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000301&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;android&#x27;</span>,<span class="number">301</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000302&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;ios&#x27;</span>,<span class="number">302</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000303&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;react native&#x27;</span>,<span class="number">303</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000304&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;ionic&#x27;</span>,<span class="number">304</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000400&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;前沿技术&#x27;</span>,<span class="number">400</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000401&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;微服务&#x27;</span>,<span class="number">401</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000402&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;区块链&#x27;</span>,<span class="number">402</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000403&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;机器学习&#x27;</span>,<span class="number">403</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000404&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;深度学习&#x27;</span>,<span class="number">404</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000405&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;数据分析&amp;挖掘&#x27;</span>,<span class="number">405</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000500&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;云计算&amp;大数据&#x27;</span>,<span class="number">500</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000501&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;大数据&#x27;</span>,<span class="number">501</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> `category` (id,parent,name,sort) <span class="keyword">values</span> (<span class="string">&#x27;00000502&#x27;</span>,<span class="string">&#x27;00000000&#x27;</span>,<span class="string">&#x27;hadoop&#x27;</span>,<span class="number">502</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>接下来mybatis-generator、前端后端生成器生成下，然后改下admin增加分类管理，然后路由增加下。</li>
</ul>
<p>分类的二级列表查询与显示：</p>
<ul>
<li><p>做成两个表格，左边一个表格是一级分类，右边是二级分类。点击一级分类时显示二级分类。</p>
</li>
<li><p>首先在CategoryService中添加</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 列表查询</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;CategoryDto&gt; <span class="title function_">all</span><span class="params">( )</span> &#123;</span><br><span class="line">        <span class="type">CategoryExample</span> <span class="variable">categoryExample</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CategoryExample</span>();</span><br><span class="line">        categoryExample.setOrderByClause(<span class="string">&quot;sort asc&quot;</span>);</span><br><span class="line">        List&lt;Category&gt; categoryList = categoryMapper.selectByExample(categoryExample);</span><br><span class="line">        List&lt;CategoryDto&gt; categoryDtoList = CopyUtil.copyList(categoryList, CategoryDto.class);</span><br><span class="line">        <span class="keyword">return</span> categoryDtoList;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>接着在CategoryController增加</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 列表查询</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/all&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseDto <span class="title function_">all</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ResponseDto</span> <span class="variable">responseDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseDto</span>();</span><br><span class="line">    List&lt;CategoryDto&gt; categoryDtoList = categoryService.all();</span><br><span class="line">    responseDto.setContent(categoryDtoList);</span><br><span class="line">    <span class="keyword">return</span> responseDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>然后再category.vue将分页全都删了，增加</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;business-category&#x27;,</span><br><span class="line">  data: function () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      category: &#123;&#125;,</span><br><span class="line">      categorys: [],</span><br><span class="line">      level1: [],</span><br><span class="line">      level2: [],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted: function () &#123;</span><br><span class="line">    let _this = this;</span><br><span class="line">    _this.all();</span><br><span class="line">  &#125;,</span><br><span class="line">  /////////////////////////////////////////////修改list</span><br><span class="line">   /**</span><br><span class="line">     * 列表查询</span><br><span class="line">     */</span><br><span class="line">    all() &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      Loading.show();</span><br><span class="line">      _this.$ajax.post(process.env.VUE_APP_SERVER +&#x27;/business/admin/category/all&#x27;).then((respond) =&gt; &#123;</span><br><span class="line">        Loading.hide();</span><br><span class="line">        let resp = respond.data;</span><br><span class="line">        _this.categorys = resp.content;</span><br><span class="line">        //将所有记录格式化成树形结构</span><br><span class="line">        for (let i = 0; i &lt; _this.categorys.length; i++) &#123;</span><br><span class="line">          let c =_this.categorys[i];</span><br><span class="line">          if(c.parent === &#x27;00000000&#x27;)&#123;</span><br><span class="line">            _this.level1.push(c);</span><br><span class="line">            for (let j = 0; j &lt; _this.categorys.length; j++) &#123;</span><br><span class="line">              let child =_this.categorys[j];</span><br><span class="line">              if(child.parent === c.id)&#123;</span><br><span class="line">                if(Tool.isEmpty(c.children))&#123;</span><br><span class="line">                  c.children = [];</span><br><span class="line">                &#125;</span><br><span class="line">                c.children.push(child);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li><p>level1的数据增加childern属性，用于存放它所有的二级分类</p>
</li>
<li><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/04/8G7p5sV4nTYwcyS.png"
                      alt="image-20220304160059706"
                ></p>
</li>
<li><p>左边一个表格是一级分类，右边是二级分类：简单来说就是再 <div class="col-md-6">中加了两个table。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;row&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;col-md-6&quot;&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">      &lt;button v-on:click=&quot;add()&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;ace-icon fa fa-edit red2&quot;&gt;&lt;/i&gt;</span><br><span class="line">        新增</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &amp;nbsp;</span><br><span class="line">      &lt;button v-on:click=&quot;all()&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;ace-icon fa fa-refresh red2&quot;&gt;&lt;/i&gt;</span><br><span class="line">        刷新</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;table id=&quot;level1-table&quot; class=&quot;table  table-bordered table-hover&quot;&gt;</span><br><span class="line">      &lt;thead&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;id&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;名称&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;顺序&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;/thead&gt;</span><br><span class="line"></span><br><span class="line">      &lt;tbody&gt;</span><br><span class="line">      &lt;tr v-for=&quot;category in level1&quot; v-on:click=&quot;onClickLevel1(category)&quot;&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;category.id&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;category.name&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;category.sort&#125;&#125;&lt;/td&gt;</span><br><span class="line"></span><br><span class="line">        &lt;td&gt;</span><br><span class="line">          &lt;div class=&quot;hidden-sm hidden-xs btn-group&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;button v-on:click=&quot;edit(category)&quot; class=&quot;btn btn-xs btn-info&quot;&gt;</span><br><span class="line">              &lt;i class=&quot;ace-icon fa fa-pencil bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line"></span><br><span class="line">            &lt;button v-on:click=&quot;del(category.id)&quot; class=&quot;btn btn-xs btn-danger&quot;&gt;</span><br><span class="line">              &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">          &lt;div class=&quot;hidden-md hidden-lg&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;inline pos-rel&quot;&gt;</span><br><span class="line">              &lt;button class=&quot;btn btn-minier btn-primary dropdown-toggle&quot; data-toggle=&quot;dropdown&quot; data-position=&quot;auto&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-cog icon-only bigger-110&quot;&gt;&lt;/i&gt;</span><br><span class="line">              &lt;/button&gt;</span><br><span class="line"></span><br><span class="line">              &lt;ul class=&quot;dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close&quot;&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;a href=&quot;#&quot; class=&quot;tooltip-info&quot; data-rel=&quot;tooltip&quot; title=&quot;View&quot;&gt;</span><br><span class="line">               &lt;span class=&quot;blue&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-search-plus bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">               &lt;/span&gt;</span><br><span class="line">                  &lt;/a&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line"></span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;a href=&quot;#&quot; class=&quot;tooltip-success&quot; data-rel=&quot;tooltip&quot; title=&quot;Edit&quot;&gt;</span><br><span class="line">               &lt;span class=&quot;green&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-pencil-square-o bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">               &lt;/span&gt;</span><br><span class="line">                  &lt;/a&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line"></span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;a href=&quot;#&quot; class=&quot;tooltip-error&quot; data-rel=&quot;tooltip&quot; title=&quot;Delete&quot;&gt;</span><br><span class="line">               &lt;span class=&quot;red&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">               &lt;/span&gt;</span><br><span class="line">                  &lt;/a&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">              &lt;/ul&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;/tbody&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div class=&quot;col-md-6&quot;&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">      &lt;button v-on:click=&quot;add()&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;ace-icon fa fa-edit red2&quot;&gt;&lt;/i&gt;</span><br><span class="line">        新增</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &amp;nbsp;</span><br><span class="line">      &lt;button v-on:click=&quot;all()&quot; class=&quot;btn btn-white btn-default btn-round&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;ace-icon fa fa-refresh red2&quot;&gt;&lt;/i&gt;</span><br><span class="line">        刷新</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;table id=&quot;level2-table&quot; class=&quot;table  table-bordered table-hover&quot;&gt;</span><br><span class="line">      &lt;thead&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;id&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;名称&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;顺序&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;/thead&gt;</span><br><span class="line"></span><br><span class="line">      &lt;tbody&gt;</span><br><span class="line">      &lt;tr v-for=&quot;category in level2&quot; &gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;category.id&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;category.name&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;category.sort&#125;&#125;&lt;/td&gt;</span><br><span class="line"></span><br><span class="line">        &lt;td&gt;</span><br><span class="line">          &lt;div class=&quot;hidden-sm hidden-xs btn-group&quot;&gt;</span><br><span class="line"></span><br><span class="line">            &lt;button v-on:click=&quot;edit(category)&quot; class=&quot;btn btn-xs btn-info&quot;&gt;</span><br><span class="line">              &lt;i class=&quot;ace-icon fa fa-pencil bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line"></span><br><span class="line">            &lt;button v-on:click=&quot;del(category.id)&quot; class=&quot;btn btn-xs btn-danger&quot;&gt;</span><br><span class="line">              &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">          &lt;div class=&quot;hidden-md hidden-lg&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;inline pos-rel&quot;&gt;</span><br><span class="line">              &lt;button class=&quot;btn btn-minier btn-primary dropdown-toggle&quot; data-toggle=&quot;dropdown&quot; data-position=&quot;auto&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-cog icon-only bigger-110&quot;&gt;&lt;/i&gt;</span><br><span class="line">              &lt;/button&gt;</span><br><span class="line"></span><br><span class="line">              &lt;ul class=&quot;dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close&quot;&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;a href=&quot;#&quot; class=&quot;tooltip-info&quot; data-rel=&quot;tooltip&quot; title=&quot;View&quot;&gt;</span><br><span class="line">               &lt;span class=&quot;blue&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-search-plus bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">               &lt;/span&gt;</span><br><span class="line">                  &lt;/a&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line"></span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;a href=&quot;#&quot; class=&quot;tooltip-success&quot; data-rel=&quot;tooltip&quot; title=&quot;Edit&quot;&gt;</span><br><span class="line">               &lt;span class=&quot;green&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-pencil-square-o bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">               &lt;/span&gt;</span><br><span class="line">                  &lt;/a&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line"></span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                  &lt;a href=&quot;#&quot; class=&quot;tooltip-error&quot; data-rel=&quot;tooltip&quot; title=&quot;Delete&quot;&gt;</span><br><span class="line">               &lt;span class=&quot;red&quot;&gt;</span><br><span class="line">                &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">               &lt;/span&gt;</span><br><span class="line">                  &lt;/a&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">              &lt;/ul&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">      &lt;/tbody&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>为左边表增加点击事件，点击右边就显示子表</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">onClickLevel1(category)&#123;</span><br><span class="line">  let _this =this;</span><br><span class="line">  _this.level2 =category.children;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>出现问题一：点击刷新的时候，会重复增加，主要是因为all事件每次都会将level1push<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/04/mITPCRfrskdY2Ee.png"
                      alt="image-20220304165944171"
                ></p>
</li>
<li><p>解决只需要再每次格式化前将level1清空即增加_this.level1 &#x3D;[];</p>
</li>
<li><p>问题二：点击左边的，出来右边时，我们需要增加一个激活效果<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/04/LMTYs7igUP2ItEh.png"
                      alt="image-20220304170305414"
                ></p>
</li>
<li><p>动态class：使用v-bind:class&#x3D;json表达式，key就是样式，value是boolean，为true时，表示key的样式生效。可以和原生的class并存</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">///////////////////////////////////////////////////////////////</span><br><span class="line">&lt;tr v-for=&quot;category in level1&quot; v-on:click=&quot;onClickLevel1(category)&quot; v-bind:class=&quot;&#123;&#x27;active&#x27;: category.id === active.id&#125;&quot;&gt;</span><br><span class="line">////////////////////////////////////////////////////</span><br><span class="line">data: function () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      category: &#123;&#125;,</span><br><span class="line">      categorys: [],</span><br><span class="line">      level1: [],</span><br><span class="line">      level2: [],</span><br><span class="line">      active: &#123;&#125;,//增加</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  /////////////////////////////////////////////////</span><br><span class="line">   onClickLevel1(category) &#123;</span><br><span class="line">        let _this = this;</span><br><span class="line">        _this.active = category;</span><br><span class="line">        _this.level2 = category.children;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> /////////////////////////////////////////////</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  .active td &#123;</span><br><span class="line">    background-color: #d6e9c6 !important;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>两级分类的新增修改删除：</p>
<ul>
<li>将两个新增标签改成新增一级，新增二级，对应的方法改为add1(),add2()，将父id改成父分类</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">  &lt;label class=&quot;col-sm-2 control-label&quot;&gt;父分类&lt;/label&gt;</span><br><span class="line">  &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">    &lt;p  class=&quot;form-control-static&quot;&gt;&#123;&#123;active.name || &quot;无&quot;&#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">//////////////////////////////////////////////////////////////////////////////////</span><br><span class="line">  /**</span><br><span class="line">     * 点击【新增一级】</span><br><span class="line">     */</span><br><span class="line">    add1() &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      _this.active = &#123;&#125;;</span><br><span class="line">      _this.level2 = [];</span><br><span class="line">      _this.category = &#123;</span><br><span class="line">        parent:&quot;00000000&quot;</span><br><span class="line">      &#125;;</span><br><span class="line">      $(&quot;#form-modal&quot;).modal(&quot;show&quot;);</span><br><span class="line">    &#125;,</span><br><span class="line">    /**</span><br><span class="line">     * 点击【新增二级】</span><br><span class="line">     */</span><br><span class="line">    add2() &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      if(Tool.isEmpty(_this.active))&#123;</span><br><span class="line">        Toast.warning(&quot;请先点击一级分类&quot;);</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">      _this.category = &#123;</span><br><span class="line">        parent:_this.active.id</span><br><span class="line">      &#125;;</span><br><span class="line">      $(&quot;#form-modal&quot;).modal(&quot;show&quot;);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li>修改CategoryService</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String id)</span>&#123;</span><br><span class="line">    deleteChildren(id);</span><br><span class="line">    categoryMapper.deleteByPrimaryKey(id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除子分类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteChildren</span><span class="params">(String id)</span> &#123;</span><br><span class="line">    <span class="type">Category</span> <span class="variable">category</span> <span class="operator">=</span> categoryMapper.selectByPrimaryKey(id);</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;00000000&quot;</span>.equals(category.getParent())) &#123;</span><br><span class="line">        <span class="comment">// 如果是一级分类，需要删除其下的二级分类</span></span><br><span class="line">        <span class="type">CategoryExample</span> <span class="variable">example</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CategoryExample</span>();</span><br><span class="line">        example.createCriteria().andParentEqualTo(category.getId());</span><br><span class="line">        categoryMapper.deleteByExample(example);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>问题：新增、编辑、删除二级分类时，没有马上刷新出来，会用到另一个小知识点</p>
</li>
<li><p>处理：对一级或二级分类的增删改查，都会调用all()刷新数据，所以all()的后面触发一次表格行点击事件。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">_this.level2 =[];</span><br><span class="line">  //对当前一级分类中选中的表格触发一次点击事件，以刷新二级菜单栏</span><br><span class="line">  //注意：界面的渲染需要等vue绑定好变量后才做，所以延迟100ms</span><br><span class="line">  setTimeout(function ()&#123;</span><br><span class="line">    $(&quot;tr.active&quot;).trigger(&quot;click&quot;);</span><br><span class="line">  &#125;,100)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>小技巧：当界面又用了jquery（特别是第三插件），当觉得代码没问题，但是效果又没出来，可以加一个小延迟看看。</li>
</ul>
<h2 id="7-4-课程和分类关联保存和显示"><a href="#7-4-课程和分类关联保存和显示" class="headerlink" title="7-4 课程和分类关联保存和显示"></a>7-4 课程和分类关联保存和显示</h2><p>集成树型展示插件zTree：<a class="link"   target="_blank" rel="noopener" href="http://www.treejs.cn/v3/main.php#_zTreeInfo" >http://www.treejs.cn/v3/main.php#_zTreeInfo<i class="fas fa-external-link-alt"></i></a></p>
<ul>
<li><p>先弄成这个样式：<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/05/dRaPCEKfeHr5jcs.png"
                      alt="image-20220305153046685"
                ></p>
</li>
<li><p>zTree是jquery插件，用于展示树型结构数据。分类数据有两层结构，可用树形结构展示。</p>
</li>
<li><p>首先再index中引入</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  zTree jquery树插件  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;zTree_v3/css/zTreeStyle/zTreeStyle.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span></span><br><span class="line">///////////////////////////////////</span><br><span class="line"><span class="comment">&lt;!--  zTree jquery树插件  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;zTree_v3-master/js/jquery.ztree.core.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;zTree_v3-master/js/jquery.ztree.excheck.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>功能设计：新增课程的时候，同时选择这门课程属于哪些分类，并且一门课程可以属于多个分类。</p>
</li>
<li><p>再course.vue表单下添加</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">  &lt;label class=&quot;col-sm-2 control-label&quot;&gt;</span><br><span class="line">    分类</span><br><span class="line">  &lt;/label&gt;</span><br><span class="line">  &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">    &lt;ul id=&quot;tree&quot; class=&quot;ztree&quot;&gt;&lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">/////////////////////////////////初始化时</span><br><span class="line">   _this.initTree();</span><br><span class="line">////////////////////////////////////////</span><br><span class="line">    initTree()&#123;</span><br><span class="line">      let setting = &#123;</span><br><span class="line">        check: &#123;</span><br><span class="line">          enable: true</span><br><span class="line">        &#125;,</span><br><span class="line">        data: &#123;</span><br><span class="line">          simpleData: &#123;</span><br><span class="line">            enable: true</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      let zNodes =[</span><br><span class="line">        &#123; id:1, pId:0, name:&quot;随意勾选 1&quot;, open:true&#125;,</span><br><span class="line">        &#123; id:11, pId:1, name:&quot;随意勾选 1-1&quot;, open:true&#125;,</span><br><span class="line">        &#123; id:111, pId:11, name:&quot;随意勾选 1-1-1&quot;&#125;,</span><br><span class="line">        &#123; id:112, pId:11, name:&quot;随意勾选 1-1-2&quot;&#125;,</span><br><span class="line">        &#123; id:12, pId:1, name:&quot;随意勾选 1-2&quot;, open:true&#125;,</span><br><span class="line">        &#123; id:121, pId:12, name:&quot;随意勾选 1-2-1&quot;&#125;,</span><br><span class="line">        &#123; id:122, pId:12, name:&quot;随意勾选 1-2-2&quot;&#125;,</span><br><span class="line">        &#123; id:2, pId:0, name:&quot;随意勾选 2&quot;, checked:true, open:true&#125;,</span><br><span class="line">        &#123; id:21, pId:2, name:&quot;随意勾选 2-1&quot;&#125;,</span><br><span class="line">        &#123; id:22, pId:2, name:&quot;随意勾选 2-2&quot;, open:true&#125;,</span><br><span class="line">        &#123; id:221, pId:22, name:&quot;随意勾选 2-2-1&quot;, checked:true&#125;,</span><br><span class="line">        &#123; id:222, pId:22, name:&quot;随意勾选 2-2-2&quot;&#125;,</span><br><span class="line">        &#123; id:23, pId:2, name:&quot;随意勾选 2-3&quot;&#125;</span><br><span class="line">      ];</span><br><span class="line">      $.fn.zTree.init($(&quot;#tree&quot;), setting, zNodes);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>将其改成这样：1.zTree数据改为分类所有记录<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/05/jo7QPzke8GR2TYm.png"
                      alt="image-20220305153545604"
                ></p>
<ul>
<li>首先将category中all方法复制修改到course中，然后初始值，接着将初始initTree更改初始allCategory，然后再allCategory中使用initTree（在第八行），接着将分支写入tree中，最后pId是zTree默认的父ID名称，而分类表是用parent，需要配置转换</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">//首先将category中all方法复制修改到course中</span><br><span class="line">allCategory() &#123;</span><br><span class="line">  let _this = this;</span><br><span class="line">  Loading.show();</span><br><span class="line">  _this.$ajax.post(process.env.VUE_APP_SERVER +&#x27;/business/admin/category/all&#x27;).then((respond) =&gt; &#123;</span><br><span class="line">    Loading.hide();</span><br><span class="line">    let resp = respond.data;</span><br><span class="line">    _this.categorys = resp.content;</span><br><span class="line">    _this.initTree();//然后再allCategory中使用initTree</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">//然后初始值</span><br><span class="line">categorys: [],</span><br><span class="line">//接着将初始initTree更改初始allCategory</span><br><span class="line"> _this.allCategory();</span><br><span class="line"> //将分支写入tree中</span><br><span class="line">let zNodes = _this.categorys;</span><br><span class="line">//pId是zTree默认的父ID名称，而分类表是用parent，需要配置转换</span><br><span class="line"> data: &#123;</span><br><span class="line">          simpleData: &#123;</span><br><span class="line">            idKey:&quot;id&quot;,</span><br><span class="line">            pIdKey:&quot;parent&quot;,</span><br><span class="line">            rootPId:&quot;00000000&quot;,</span><br><span class="line">            enable: true</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>保存课程时，同时保存课程分类：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.保存课程时，同时保存课程分类</span><br><span class="line">2.增加课程分类关联表，一门课程可以属于多个分类</span><br></pre></td></tr></table></figure>

<ul>
<li>首先创建sql语句</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#课程分类</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `course_category`;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> `course_category`(</span><br><span class="line">            `id` <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> comment <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">            `course_id` <span class="type">char</span>(<span class="number">8</span>) comment <span class="string">&#x27;课程|course.id&#x27;</span>,</span><br><span class="line">            `category_id` <span class="type">char</span>(<span class="number">8</span>) comment <span class="string">&#x27;分类|course.id&#x27;</span>,</span><br><span class="line"></span><br><span class="line">             <span class="keyword">primary</span> key (`id`)</span><br><span class="line">)engine <span class="operator">=</span>innodb <span class="keyword">default</span> charset<span class="operator">=</span>utf8mb4 comment<span class="operator">=</span><span class="string">&#x27;课程分类&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>接着就是代码生成器，不需要前端的，所以也不需要controller。</p>
</li>
<li><p>在course.vue中进行代码的修改</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//在data中定义tree</span><br><span class="line">tree: &#123;&#125;,</span><br><span class="line">//再保存中进行一些弹框提示</span><br><span class="line">let categorys = _this.tree.getCheckedNodes();</span><br><span class="line">if(Tool.isEmpty(categorys))&#123;</span><br><span class="line">  Toast.warning(&quot;请选择分类!&quot;);</span><br><span class="line">  return;</span><br><span class="line">&#125;</span><br><span class="line">_this.course.categorys =categorys;</span><br><span class="line">//将这个赋值到tree</span><br><span class="line">_this.tree = $.fn.zTree.init($(&quot;#tree&quot;), setting, zNodes);</span><br></pre></td></tr></table></figure>

<ul>
<li>在courseDto中增加一个变量</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;CategoryDto&gt; categorys;<span class="comment">//属性名和前端传递的参数名一致，这样spring会自动映射参数</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在CourseService中save中增加</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> CourseCategoryService courseCategoryService;</span><br><span class="line">   </span><br><span class="line"><span class="comment">//批量保存课程分类</span></span><br><span class="line">courseCategoryService.saveBatch(courseDto.getId(),courseDto.getCategorys());</span><br></pre></td></tr></table></figure>

<ul>
<li>在CourseCategoryService增加saveBatch方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveBatch</span><span class="params">(String courseId, List&lt;CategoryDto&gt; dtoList)</span>&#123;</span><br><span class="line">    <span class="type">CourseCategoryExample</span> <span class="variable">example</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseCategoryExample</span>();</span><br><span class="line">    example.createCriteria().andCourseIdEqualTo(courseId);</span><br><span class="line">    courseCategoryMapper.deleteByExample(example);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>,l = dtoList.size(); i &lt; l; i++) &#123;</span><br><span class="line">        <span class="type">CategoryDto</span> <span class="variable">categoryDto</span> <span class="operator">=</span> dtoList.get(i);</span><br><span class="line">        <span class="type">CourseCategory</span> <span class="variable">courseCategory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseCategory</span>();</span><br><span class="line">        courseCategory.setId(UuidUtil.getShortUuid());</span><br><span class="line">        courseCategory.setCourseId(courseId);</span><br><span class="line">        courseCategory.setCategoryId(categoryDto.getId());</span><br><span class="line">        insert(courseCategory);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>我们只需要保存分类的ID，所以数据传输可以选择id数组，也可以选择category数组</p>
</li>
<li><p>也可以通过自定义的mapper写动态sql，将list传入mybatis，批量插入一批数据，只要一条insert语句。项目开发需要在开发效率和运行效率间找平衡。</p>
</li>
<li><p>问题：保存课程时，调用saveBatch，那么课程新增时，还会批量插入数据，课程更新时，会再次批量插入数据，每次调用保存都会批量插入数据</p>
</li>
</ul>
<p>编辑课程时，加载课程分类树，并设置勾选：</p>
<ul>
<li>首先在CourseService增加一个事务，</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 保存，id有值时更新，无值时新增</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>外层save增加了事务，saveBatch按理可以不加事务。但是由于本身也是多个sql操作，且以后可能被多个地方调用，为了防止外层save忘记加事务，所以在saveBatch加事务，以防外一。</p>
</li>
<li><p>在CourseCategoryService中增加,其次在saveBatch也增加一个事务</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 根据某一课程，前清空课程分类，再保存课程分类</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> courseId</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> dtoList</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="comment">///////////////////////////////////////////////</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CourseCategoryDto&gt; <span class="title function_">listByCourse</span><span class="params">(String courseId)</span>&#123;</span><br><span class="line">    <span class="type">CourseCategoryExample</span> <span class="variable">example</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseCategoryExample</span>();</span><br><span class="line">    example.createCriteria().andCourseIdEqualTo(courseId);</span><br><span class="line">    List&lt;CourseCategory&gt; courseCategoryList = courseCategoryMapper.selectByExample(example);</span><br><span class="line">    <span class="keyword">return</span> CopyUtil.copyList(courseCategoryList,CourseCategoryDto.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在coursecontroller中增加一个方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 查找课程下所有分类</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping</span> (<span class="string">&quot;/list-category/&#123;courseId&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> ResponseDto <span class="title function_">listCategory</span><span class="params">(<span class="meta">@PathVariable(value = &quot;courseId&quot;)</span>  String courseId)</span>&#123;</span><br><span class="line">    <span class="type">ResponseDto</span> <span class="variable">responseDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseDto</span>();</span><br><span class="line">    List&lt;CourseCategoryDto&gt; dtoList = courseCategoryService.listByCourse(courseId);</span><br><span class="line">    responseDto.setContent(dtoList);</span><br><span class="line">    <span class="keyword">return</span> responseDto;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>最后在course.vue中增加</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">add() &#123;</span><br><span class="line">  _this.tree.checkAllNodes(false);</span><br><span class="line">&#125;,</span><br><span class="line">/////////////////</span><br><span class="line">edit(course) &#123;   </span><br><span class="line">  _this.listCategory(course.id);</span><br><span class="line">&#125;,</span><br><span class="line">//////////////////////</span><br><span class="line"> /**</span><br><span class="line">     * 查找课程下所有分类</span><br><span class="line">     * @param courseId</span><br><span class="line">     */</span><br><span class="line">    listCategory(courseId) &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      Loading.show();</span><br><span class="line">      _this.$ajax.post(process.env.VUE_APP_SERVER + &#x27;/business/admin/course/list-category/&#x27; + courseId).then((res)=&gt;&#123;</span><br><span class="line">        Loading.hide();</span><br><span class="line">        console.log(&quot;查找课程下所有分类结果：&quot;, res);</span><br><span class="line">        let response = res.data;</span><br><span class="line">        let categorys = response.content;</span><br><span class="line"></span><br><span class="line">        // 勾选查询到的分类</span><br><span class="line">        _this.tree.checkAllNodes(false);</span><br><span class="line">        for (let i = 0; i &lt; categorys.length; i++) &#123;</span><br><span class="line">          let node = _this.tree.getNodeByParam(&quot;id&quot;, categorys[i].categoryId);</span><br><span class="line">          _this.tree.checkNode(node, true);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="7-5-课程内容功能开发"><a href="#7-5-课程内容功能开发" class="headerlink" title="7-5 课程内容功能开发"></a>7-5 课程内容功能开发</h2><p>课程内容表的设计与基本代码的生成：</p>
<ul>
<li>all.sql生成代码</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#课程内容</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `course_content`;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> `course_content`(</span><br><span class="line">            `id` <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> comment <span class="string">&#x27;课程id&#x27;</span>,</span><br><span class="line">            `content` mediumtext <span class="keyword">not</span> <span class="keyword">null</span>  comment <span class="string">&#x27;课程内容&#x27;</span>,</span><br><span class="line">             <span class="keyword">primary</span> key (`id`)</span><br><span class="line">)engine <span class="operator">=</span>innodb <span class="keyword">default</span> charset<span class="operator">=</span>utf8mb4 comment<span class="operator">=</span><span class="string">&#x27;课程内容&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>课程表和课程内容表是1：1的关系，两张表都用同样的字段</li>
<li>课程详情一般会有文字，图片，视频等，虽然不会把整张图片或者整个视频放到数据库，但是存的信息还是很多，所以用大字段。mediumtext比text类型长度更长。</li>
<li>然后依旧mybatis和后端生成器生成代码。</li>
<li>表里有大字段时，就会生成withBLOBs方法（在service中）</li>
</ul>
<p>完成课程内容管理功能：</p>
<ul>
<li><p>富文本编辑器，一个很重要的特性：所见即所得</p>
</li>
<li><p>课程内容，只有读和写，没有列表查询，也没有删除</p>
</li>
<li><p>新增课程的时候，course表有数据，course_content表没有数据。</p>
</li>
<li><p>正常思路，先去select，看看有没有数据，再判断时insert还是update，这样会执行两个sql。其实可以直接更新，没有更新到再插入，只有第一次会更新不到，执行两次sql，后面都只需要一个sql</p>
</li>
<li><p>首先在CourseService中插入</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Resource</span></span><br><span class="line"> <span class="keyword">private</span> CourseContentMapper courseContentMapper;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查找课程内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> CourseContentDto <span class="title function_">findContent</span><span class="params">(String id)</span>&#123;</span><br><span class="line">    <span class="type">CourseContent</span> <span class="variable">content</span> <span class="operator">=</span> courseContentMapper.selectByPrimaryKey(id);</span><br><span class="line">    <span class="keyword">if</span>(content == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> CopyUtil.copy(content,CourseContentDto.class);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 保存课程内容，包含新增和修改</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">saveContent</span><span class="params">(CourseContentDto contentDto)</span>&#123;</span><br><span class="line">    <span class="type">CourseContent</span> <span class="variable">content</span> <span class="operator">=</span> CopyUtil.copy(contentDto,CourseContent.class);</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> courseContentMapper.updateByPrimaryKeyWithBLOBs(content);</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span>)&#123;</span><br><span class="line">        i = courseContentMapper.insert(content);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>其次在controller中将service中写的两个方法都暴露出去</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span> (<span class="string">&quot;/find-content/&#123;id&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> ResponseDto <span class="title function_">findContent</span><span class="params">(<span class="meta">@PathVariable</span>  String id)</span>&#123;</span><br><span class="line">    <span class="type">ResponseDto</span> <span class="variable">responseDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseDto</span>();</span><br><span class="line">    <span class="type">CourseContentDto</span> <span class="variable">contentDto</span> <span class="operator">=</span> courseService.findContent(id);</span><br><span class="line">    responseDto.setContent(contentDto);</span><br><span class="line">    <span class="keyword">return</span> responseDto;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(&quot;/save-content&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseDto <span class="title function_">saveContent</span><span class="params">(<span class="meta">@RequestBody</span> CourseContentDto contentDto)</span> &#123;</span><br><span class="line">    <span class="type">ResponseDto</span> <span class="variable">responseDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseDto</span>();</span><br><span class="line">    courseService.saveContent(contentDto);</span><br><span class="line">    <span class="keyword">return</span> responseDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>接着在index中引入富文本的css和js</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">!-- include summernote css/js --&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>最後在course.vue中添加代碼</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&lt;button v-on:click=<span class="string">&quot;editContent(course)&quot;</span> class=<span class="string">&quot;btn btn-white btn-xs btn-info btn-round&quot;</span>&gt;</span><br><span class="line">  内容</span><br><span class="line">&lt;/button&gt;&amp;nbsp;&amp;nbsp;</span><br><span class="line"><span class="comment">/////////////////////////////////////</span></span><br><span class="line">  &lt;div id=<span class="string">&quot;course-content-modal&quot;</span> class=<span class="string">&quot;modal fade&quot;</span> tabindex=<span class="string">&quot;-1&quot;</span> role=<span class="string">&quot;dialog&quot;</span>&gt;</span><br><span class="line">      &lt;div class=<span class="string">&quot;modal-dialog&quot;</span> role=<span class="string">&quot;document&quot;</span>&gt;</span><br><span class="line">        &lt;div class=<span class="string">&quot;modal-content&quot;</span>&gt;</span><br><span class="line">          &lt;div class=<span class="string">&quot;modal-header&quot;</span>&gt;</span><br><span class="line">            &lt;button type=<span class="string">&quot;button&quot;</span> class=<span class="string">&quot;close&quot;</span> data-dismiss=<span class="string">&quot;modal&quot;</span> aria-label=<span class="string">&quot;Close&quot;</span>&gt;&lt;span aria-hidden=<span class="string">&quot;true&quot;</span>&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;</span><br><span class="line">            &lt;h4 class=<span class="string">&quot;modal-title&quot;</span>&gt;内容编辑&lt;/h4&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=<span class="string">&quot;modal-body&quot;</span>&gt;</span><br><span class="line">            &lt;form class=<span class="string">&quot;form-horizontal&quot;</span>&gt;</span><br><span class="line">              &lt;div class=<span class="string">&quot;form-group&quot;</span>&gt;</span><br><span class="line">                &lt;div class=<span class="string">&quot;col-lg-12&quot;</span>&gt;</span><br><span class="line">                  &lt;div id=<span class="string">&quot;content&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=<span class="string">&quot;modal-footer&quot;</span>&gt;</span><br><span class="line">            &lt;button type=<span class="string">&quot;button&quot;</span> class=<span class="string">&quot;btn btn-default&quot;</span> data-dismiss=<span class="string">&quot;modal&quot;</span>&gt;</span><br><span class="line">              &lt;i class=<span class="string">&quot;ace-icon fa fa-times&quot;</span>&gt;&lt;/i&gt;</span><br><span class="line">              取消</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">            &lt;button v-on:click=<span class="string">&quot;saveContent()&quot;</span> type=<span class="string">&quot;button&quot;</span> class=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span><br><span class="line">              &lt;i class=<span class="string">&quot;ace-icon fa fa-plus blue&quot;</span>&gt;&lt;/i&gt;</span><br><span class="line">              保存</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;&lt;!-- /.modal-content --&gt;</span><br><span class="line">      &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;</span><br><span class="line">    &lt;/div&gt;&lt;!-- /.modal --&gt;</span><br><span class="line"><span class="comment">///////////////////////////////////////////////</span></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 打开内容编辑</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    editContent(course) &#123;</span><br><span class="line">      <span class="type">let</span> <span class="variable">_this</span> <span class="operator">=</span> <span class="built_in">this</span>;</span><br><span class="line">      <span class="type">let</span> <span class="variable">id</span> <span class="operator">=</span> course.id;</span><br><span class="line">      _this.course =course;</span><br><span class="line">      $(<span class="string">&quot;#content&quot;</span>).summernote(&#123;</span><br><span class="line">        focus: <span class="literal">true</span>,</span><br><span class="line">        height: <span class="number">300</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 先清空历史文本</span></span><br><span class="line">      $(<span class="string">&quot;#content&quot;</span>).summernote(<span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Loading.show();</span><br><span class="line">      _this.$ajax.get(process.env.VUE_APP_SERVER + <span class="string">&#x27;/business/admin/course/find-content/&#x27;</span> + id).then((response)=&gt;&#123;</span><br><span class="line">        Loading.hide();</span><br><span class="line">        <span class="type">let</span> <span class="variable">resp</span> <span class="operator">=</span> response.data;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (resp.success) &#123;</span><br><span class="line">          <span class="keyword">if</span> (resp.content) &#123;</span><br><span class="line">            $(<span class="string">&quot;#content&quot;</span>).summernote(<span class="string">&#x27;code&#x27;</span>, resp.content.content);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          Toast.warning(resp.message);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">   </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存内容</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    saveContent () &#123;</span><br><span class="line">      <span class="type">let</span> <span class="variable">_this</span> <span class="operator">=</span> <span class="built_in">this</span>;</span><br><span class="line">      <span class="type">let</span> <span class="variable">content</span> <span class="operator">=</span> $(<span class="string">&quot;#content&quot;</span>).summernote(<span class="string">&quot;code&quot;</span>);</span><br><span class="line">      _this.$ajax.post(process.env.VUE_APP_SERVER + <span class="string">&#x27;/business/admin/course/save-content&#x27;</span>, &#123;</span><br><span class="line">        id: _this.course.id,</span><br><span class="line">        content: content</span><br><span class="line">      &#125;).then((response)=&gt;&#123;</span><br><span class="line">        Loading.hide();</span><br><span class="line">        <span class="type">let</span> <span class="variable">resp</span> <span class="operator">=</span> response.data;</span><br><span class="line">        <span class="keyword">if</span> (resp.success) &#123;</span><br><span class="line">          Toast.success(<span class="string">&quot;内容保存成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          Toast.warning(resp.message);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<p>利用setInterval完成自動保存功能：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.利用setInterval完成自动保存功能</span><br><span class="line">2.增加js日期格式化方法</span><br></pre></td></tr></table></figure>

<ul>
<li><p>setInterval，重复的定时任务；setTimeout，只执行一次的定时任务</p>
</li>
<li><p>在editContent中增加。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//自動保存功能</span><br><span class="line">let saveContentInterval = setInterval(function ()&#123;</span><br><span class="line">  _this.saveContent();</span><br><span class="line">&#125;,5000);</span><br><span class="line">//关闭内容框时，情况自动保存功能</span><br><span class="line">$(&#x27;course-content-modal&#x27;).on(&#x27;hidden.bs.modal&#x27;,function (e)&#123;</span><br><span class="line">  clearInterval(saveContentInterval);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://s2.loli.net/2022/03/07/5IEnyTGtJkpHu62.png"
                      alt="image-20220307112732051"
                ></p>
<ul>
<li>这样写右上角总是出现下面这个框，所以做以下修改，在tool.js增加一个日期格式化方法</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 时间格式化，date为空时取当前时间</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="attr">dateFormat</span>: <span class="keyword">function</span> (<span class="params">format, date</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> result;</span><br><span class="line">  <span class="keyword">if</span> (!date) &#123;</span><br><span class="line">    date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> option = &#123;</span><br><span class="line">    <span class="string">&quot;y+&quot;</span>: date.<span class="title function_">getFullYear</span>().<span class="title function_">toString</span>(),        <span class="comment">// 年</span></span><br><span class="line">    <span class="string">&quot;M+&quot;</span>: (date.<span class="title function_">getMonth</span>() + <span class="number">1</span>).<span class="title function_">toString</span>(),     <span class="comment">// 月</span></span><br><span class="line">    <span class="string">&quot;d+&quot;</span>: date.<span class="title function_">getDate</span>().<span class="title function_">toString</span>(),            <span class="comment">// 日</span></span><br><span class="line">    <span class="string">&quot;h+&quot;</span>: date.<span class="title function_">getHours</span>().<span class="title function_">toString</span>(),           <span class="comment">// 时</span></span><br><span class="line">    <span class="string">&quot;m+&quot;</span>: date.<span class="title function_">getMinutes</span>().<span class="title function_">toString</span>(),         <span class="comment">// 分</span></span><br><span class="line">    <span class="string">&quot;s+&quot;</span>: date.<span class="title function_">getSeconds</span>().<span class="title function_">toString</span>()          <span class="comment">// 秒</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> option) &#123;</span><br><span class="line">    result = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&quot;(&quot;</span> + i + <span class="string">&quot;)&quot;</span>).<span class="title function_">exec</span>(format);</span><br><span class="line">    <span class="keyword">if</span> (result) &#123;</span><br><span class="line">      format = format.<span class="title function_">replace</span>(result[<span class="number">1</span>], (result[<span class="number">1</span>].<span class="property">length</span> == <span class="number">1</span>) ? (option[i]) : (option[i].<span class="title function_">padStart</span>(result[<span class="number">1</span>].<span class="property">length</span>, <span class="string">&quot;0&quot;</span>)))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> format;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li>然后在course.vue增加，在富文本内容上增加一个时间标签</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;col-lg-12&quot;&gt;</span><br><span class="line">    &#123;&#123;saveContentLable&#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">//定义变量</span><br><span class="line">saveContentLabel:&quot;&quot;,</span><br><span class="line">//在每次打开editContent每次都要情况历史文本</span><br><span class="line"> _this.saveContentLabel = &quot;&quot;;</span><br><span class="line">//在saveContent中加入</span><br><span class="line">if (resp.success) &#123;</span><br><span class="line">    let now = Tool.dateFormat(&quot;mm:ss&quot;);</span><br><span class="line">    _this.saveContentLabel = &quot;最后保存时间: &quot;+now;</span><br><span class="line">&#125;		</span><br></pre></td></tr></table></figure>

<h2 id="7-6-课程代码优化"><a href="#7-6-课程代码优化" class="headerlink" title="7-6 课程代码优化"></a>7-6 课程代码优化</h2><p>课程自定义排序：</p>
<ul>
<li><p>注意用法：小节的顺序是可以重复的，每一章里的小节都可以从1开始排序</p>
</li>
<li><p>首先在course.vue中进行修改</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">&lt;button v-on:click=&quot;openSortModal(course)&quot; class=&quot;btn btn-white btn-xs btn-info btn-round&quot;&gt;</span><br><span class="line">  排序</span><br><span class="line">&lt;/button&gt;&amp;nbsp;&amp;nbsp;</span><br><span class="line">////增加disabled</span><br><span class="line"> &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line"> 	&lt;label  class=&quot;col-sm-2 control-label&quot;&gt;顺序&lt;/label&gt;</span><br><span class="line"> 	&lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">		 &lt;input v-model=&quot;course.sort&quot; class=&quot;form-control&quot; disabled &gt;</span><br><span class="line"> 	&lt;/div&gt;</span><br><span class="line"> &lt;/div&gt;</span><br><span class="line">//增加模态框</span><br><span class="line">  &lt;div id=&quot;course-sort-modal&quot; class=&quot;modal fade&quot; tabindex=&quot;-1&quot; role=&quot;dialog&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;modal-dialog&quot; role=&quot;document&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;modal-header&quot;&gt;</span><br><span class="line">            &lt;button type=&quot;button&quot; class=&quot;close&quot; data-dismiss=&quot;modal&quot; aria-label=&quot;Close&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;times;&lt;/span&gt;&lt;/button&gt;</span><br><span class="line">            &lt;h4 class=&quot;modal-title&quot;&gt;排序&lt;/h4&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">            &lt;form class=&quot;form-horizontal&quot;&gt;</span><br><span class="line">              &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                &lt;label class=&quot;control-label col-lg-3&quot;&gt;</span><br><span class="line">                  当前排序</span><br><span class="line">                &lt;/label&gt;</span><br><span class="line">                &lt;div class=&quot;col-lg-9&quot;&gt;</span><br><span class="line">                  &lt;input class=&quot;form-control&quot; v-model=&quot;sort.oldSort&quot; name=&quot;oldSort&quot; disabled&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">                &lt;label class=&quot;control-label col-lg-3&quot;&gt;</span><br><span class="line">                  新排序</span><br><span class="line">                &lt;/label&gt;</span><br><span class="line">                &lt;div class=&quot;col-lg-9&quot;&gt;</span><br><span class="line">                  &lt;input class=&quot;form-control&quot; v-model=&quot;sort.newSort&quot; name=&quot;newSort&quot;&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">            &lt;button type=&quot;button&quot; class=&quot;btn btn-white btn-default btn-round&quot; data-dismiss=&quot;modal&quot;&gt;</span><br><span class="line">              &lt;i class=&quot;ace-icon fa fa-times&quot;&gt;&lt;/i&gt;</span><br><span class="line">              取消</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">            &lt;button type=&quot;button&quot; class=&quot;btn btn-white btn-info btn-round&quot; v-on:click=&quot;updateSort()&quot;&gt;</span><br><span class="line">              &lt;i class=&quot;ace-icon fa fa-plus blue&quot;&gt;&lt;/i&gt;</span><br><span class="line">              更新排序</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;&lt;!-- /.modal-content --&gt;</span><br><span class="line">      &lt;/div&gt;&lt;!-- /.modal-dialog --&gt;</span><br><span class="line">    &lt;/div&gt;&lt;!-- /.modal --&gt;</span><br><span class="line">//data增加变量</span><br><span class="line"> sort: &#123;</span><br><span class="line">        id: &quot;&quot;,</span><br><span class="line">        oldSort: 0,</span><br><span class="line">        newSort: 0</span><br><span class="line">      &#125;,</span><br><span class="line">//在添加方法增加</span><br><span class="line">_this.course = &#123;</span><br><span class="line">  sort: _this.$refs.pagination.total+1</span><br><span class="line">   &#125;;</span><br><span class="line">//增加两个方法</span><br><span class="line"></span><br><span class="line">    openSortModal(course) &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      _this.sort = &#123;</span><br><span class="line">        id: course.id,</span><br><span class="line">        oldSort: course.sort,</span><br><span class="line">        newSort: course.sort</span><br><span class="line">      &#125;;</span><br><span class="line">      $(&quot;#course-sort-modal&quot;).modal(&quot;show&quot;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 排序</span><br><span class="line">     */</span><br><span class="line">    updateSort() &#123;</span><br><span class="line">      let _this = this;</span><br><span class="line">      if (_this.sort.newSort === _this.sort.oldSort) &#123;</span><br><span class="line">        Toast.warning(&quot;排序没有变化&quot;);</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">      Loading.show();</span><br><span class="line">      _this.$ajax.post(process.env.VUE_APP_SERVER + &quot;/business/admin/course/sort&quot;, _this.sort).then((res) =&gt; &#123;</span><br><span class="line">        let response = res.data;</span><br><span class="line"></span><br><span class="line">        if (response.success) &#123;</span><br><span class="line">          Toast.success(&quot;更新排序成功&quot;);</span><br><span class="line">          $(&quot;#course-sort-modal&quot;).modal(&quot;hide&quot;);</span><br><span class="line">          _this.list(1);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          Toast.error(&quot;更新排序失败&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>其次增加SortDto</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.course.server.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SortDto</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前排序</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> oldSort;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新排序</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> newSort;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(String id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getNewSort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> newSort;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNewSort</span><span class="params">(<span class="type">int</span> newSort)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.newSort = newSort;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getOldSort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> oldSort;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOldSort</span><span class="params">(<span class="type">int</span> oldSort)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.oldSort = oldSort;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(<span class="string">&quot;SortDto&#123;&quot;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;id=&#x27;&quot;</span>).append(id).append(<span class="string">&#x27;\&#x27;&#x27;</span>);</span><br><span class="line">        sb.append(<span class="string">&quot;, oldSort=&quot;</span>).append(oldSort);</span><br><span class="line">        sb.append(<span class="string">&quot;, newSort=&quot;</span>).append(newSort);</span><br><span class="line">        sb.append(<span class="string">&#x27;&#125;&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>然后我们在coursecontroller添加</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/sort&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseDto <span class="title function_">sort</span><span class="params">(<span class="meta">@RequestBody</span> SortDto sortDto)</span> &#123;</span><br><span class="line">    LOG.info(<span class="string">&quot;更新排序&quot;</span>);</span><br><span class="line">    <span class="type">ResponseDto</span> <span class="variable">responseDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseDto</span>();</span><br><span class="line">    courseService.sort(sortDto);</span><br><span class="line">    <span class="keyword">return</span> responseDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在CourseService中进行</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//批量保存课程分类</span></span><br><span class="line">courseCategoryService.saveBatch(course.getId(),courseDto.getCategorys());<span class="comment">//这改了，之前是coursedto，新增课程的时候coursedto.id没有值,应该用course.id</span></span><br><span class="line"><span class="comment">//增加方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 排序</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sortDto</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(SortDto sortDto)</span>&#123;</span><br><span class="line">        <span class="comment">//修改当前记录的排序值</span></span><br><span class="line">        myCourseMapper.updateSort(sortDto);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//如果排序值变大</span></span><br><span class="line">        <span class="keyword">if</span> (sortDto.getNewSort()&gt;sortDto.getOldSort())&#123;</span><br><span class="line">            myCourseMapper.moveSortsForward(sortDto);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果排序值变小</span></span><br><span class="line">        <span class="keyword">if</span> (sortDto.getNewSort()&lt;sortDto.getOldSort())&#123;</span><br><span class="line">            myCourseMapper.moveSortsBackward(sortDto);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在MyCourseMapper创建CourseService调用的方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">updateSort</span><span class="params">(SortDto sortDto)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">moveSortsForward</span><span class="params">(SortDto sortDto)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">moveSortsBackward</span><span class="params">(SortDto sortDto)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>在MyCourseMapper.xml写对应接口</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateSort&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.course.server.dto.SortDto&quot;</span>&gt;</span></span><br><span class="line">    update course set `sort`= #&#123;newSort&#125; where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;moveSortsBackward&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.course.server.dto.SortDto&quot;</span>&gt;</span></span><br><span class="line">    &lt;![CDATA[</span><br><span class="line">    update course set `sort`= (`sort`+1) where `sort` &gt;= #&#123;newSort&#125; and `sort` &lt;= #&#123;oldSort&#125; and id != #&#123;id&#125;</span><br><span class="line">    ]]&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;moveSortsForward&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.course.server.dto.SortDto&quot;</span>&gt;</span></span><br><span class="line">    &lt;![CDATA[</span><br><span class="line">    update course set `sort`= (`sort`-1) where `sort` &lt;= #&#123;newSort&#125; and `sort` &gt;= #&#123;oldSort&#125; and id != #&#123;id&#125;</span><br><span class="line">    ]]&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>菜单隐藏掉大章和小节：</p>
<ul>
<li><p>修改一：菜单栏不出现大章管理和小节管理</p>
</li>
<li><p>首先admin中注释掉大章和小节管理</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--   &lt;li class=&quot;active&quot; id=&quot;business-chapter-sidebar&quot;&gt;--&gt;</span><br><span class="line">&lt;!--                &lt;router-link to=&quot;/business/chapter&quot;&gt;--&gt;</span><br><span class="line">&lt;!--                  &lt;i class=&quot;menu-icon fa fa-caret-right&quot;&gt;&lt;/i&gt;--&gt;</span><br><span class="line">&lt;!--                  大章管理--&gt;</span><br><span class="line">&lt;!--                &lt;/router-link&gt;--&gt;</span><br><span class="line">&lt;!--                &lt;b class=&quot;arrow&quot;&gt;&lt;/b&gt;--&gt;</span><br><span class="line">&lt;!--              &lt;/li&gt;--&gt;</span><br><span class="line">&lt;!--              &lt;li class=&quot;active&quot; id=&quot;business-section-sidebar&quot;&gt;--&gt;</span><br><span class="line">&lt;!--                &lt;router-link to=&quot;/business/section&quot;&gt;--&gt;</span><br><span class="line">&lt;!--                  &lt;i class=&quot;menu-icon fa fa-caret-right&quot;&gt;&lt;/i&gt;--&gt;</span><br><span class="line">&lt;!--                  小节管理--&gt;</span><br><span class="line">&lt;!--                &lt;/router-link&gt;--&gt;</span><br><span class="line">&lt;!--                &lt;b class=&quot;arrow&quot;&gt;&lt;/b&gt;--&gt;</span><br><span class="line">&lt;!--              &lt;/li&gt;--&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改2：页面进入大章管理和小节管理时，侧边栏的课程管理应该显示激活样式</p>
</li>
<li><p>然后再chapter和section都加上激活样式</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//sidebar激活样式方法一</span><br><span class="line">this.$parent.activeSidebar(&quot;business-course-sidebar&quot;);</span><br></pre></td></tr></table></figure>

<p>sessionStorage的key改成常量：</p>
<ul>
<li><p>key值不要直接写字符串，后面缓存用得越来越多；key名有可能冲突，这时要改key名的话所有set和get都要改。且不要用单一的单词，最好加一些前后缀。</p>
</li>
<li><p>在SessionStorage.js中添加常量</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">SESSION_KEY_COURSE</span> = <span class="string">&quot;SESSION_KEY_COURSE&quot;</span>; <span class="comment">// 课程管理页面点击章管理时，保存课程信息</span></span><br><span class="line"><span class="variable constant_">SESSION_KEY_CHAPTER</span> = <span class="string">&quot;SESSION_KEY_CHAPTER&quot;</span>; <span class="comment">// 章管理页面点击节管理时，保存章信息</span></span><br></pre></td></tr></table></figure>

<ul>
<li>然后再course和chapter和section中都修改SessionStorage方法的key</li>
</ul>
<p>表格内文字上下居中：</p>
<ul>
<li>在static中创建css文件夹建立style.css文件，在index中引入css</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*表格内容上下居中显示*/</span></span><br><span class="line"><span class="selector-class">.table</span> <span class="selector-tag">td</span>&#123;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-7-讲师管理功能开发"><a href="#7-7-讲师管理功能开发" class="headerlink" title="7-7 讲师管理功能开发"></a>7-7 讲师管理功能开发</h2><p>增加讲师管理功能：</p>
<ul>
<li><p>注意：菜单去掉了大章和小节，但是路由不能去</p>
</li>
<li><p>简介要改成多行文本框textarea</p>
</li>
<li><p>all.sql增加</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#讲师</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `teacher`;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> `teacher`(</span><br><span class="line">            `id` <span class="type">char</span>(<span class="number">8</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> comment <span class="string">&#x27;课程id&#x27;</span>,</span><br><span class="line">            `name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;名称&#x27;</span>,</span><br><span class="line">            `nickname` <span class="type">varchar</span>(<span class="number">50</span>)  comment <span class="string">&#x27;昵称&#x27;</span>,</span><br><span class="line">            `image` <span class="type">varchar</span>(<span class="number">100</span>)  comment <span class="string">&#x27;头像&#x27;</span>,</span><br><span class="line">            `position` <span class="type">varchar</span>(<span class="number">50</span>)  comment <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line">            `motto` <span class="type">varchar</span>(<span class="number">50</span>)  comment <span class="string">&#x27;座右铭&#x27;</span>,</span><br><span class="line">            `intro` <span class="type">varchar</span>(<span class="number">500</span>)  comment <span class="string">&#x27;简介&#x27;</span>,</span><br><span class="line">             <span class="keyword">primary</span> key (`id`)</span><br><span class="line">)engine <span class="operator">=</span>innodb <span class="keyword">default</span> charset<span class="operator">=</span>utf8mb4 comment<span class="operator">=</span><span class="string">&#x27;讲师&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>然后就是各种代码生成器，然后admin中和router中添加相应模块和路由。</li>
</ul>
<p>讲师管理布局优化：</p>
<ul>
<li>只需要改teacher.vue，table删了，加上这个。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;row&quot;&gt;</span><br><span class="line">  &lt;div v-for=&quot;teacher in teachers&quot; class=&quot;col-md-3&quot;&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;span class=&quot;profile-picture&quot;&gt;</span><br><span class="line">        &lt;img v-show=&quot;!teacher.image&quot; class=&quot;editable img-responsive editable-click editable-empty&quot; src=&quot;/static/image/讲师头像/头像1.jpg&quot; v-bind:title=&quot;teacher.intro&quot;/&gt;</span><br><span class="line">        &lt;img v-show=&quot;teacher.image&quot; class=&quot;editable img-responsive editable-click editable-empty&quot; v-bind:src=&quot;teacher.image&quot; v-bind:title=&quot;teacher.intro&quot;/&gt;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;space-4&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;width-85 label label-info label-xlg arrowed-in arrowed-in-right&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;inline position-relative&quot;&gt;</span><br><span class="line">          &lt;a href=&quot;javascript:;&quot; class=&quot;user-title-label dropdown-toggle&quot; data-toggle=&quot;dropdown&quot;&gt;</span><br><span class="line">            &lt;i class=&quot;ace-icon fa fa-circle light-green&quot;&gt;&lt;/i&gt;</span><br><span class="line">            &amp;nbsp;</span><br><span class="line">            &lt;span class=&quot;white&quot;&gt;&#123;&#123;teacher.position&#125;&#125;&lt;/span&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;space-6&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;text-center&quot;&gt;</span><br><span class="line">      &lt;a href=&quot;javascript:;&quot; class=&quot;text-info bigger-110&quot; v-bind:title=&quot;teacher.motto&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;ace-icon fa fa-user&quot;&gt;&lt;/i&gt;</span><br><span class="line">        &#123;&#123;teacher.name&#125;&#125;【&#123;&#123;teacher.nickname&#125;&#125;】</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;space-6&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;profile-social-links align-center&quot;&gt;</span><br><span class="line">      &lt;button v-on:click=&quot;edit(teacher)&quot; class=&quot;btn btn-xs btn-info&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;ace-icon fa fa-pencil bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">      &amp;nbsp;</span><br><span class="line">      &lt;button v-on:click=&quot;del(teacher.id)&quot; class=&quot;btn btn-xs btn-danger&quot;&gt;</span><br><span class="line">        &lt;i class=&quot;ace-icon fa fa-trash-o bigger-120&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">    &lt;div class=&quot;hr hr16 dotted&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">//再把简介的input修改</span><br><span class="line">&lt;textarea v-model=&quot;teacher.intro&quot; class=&quot;form-control&quot; rows=&quot;5&quot;&gt;&lt;/textarea&gt;</span><br></pre></td></tr></table></figure>

<p>课程讲师的关联：</p>
<ul>
<li><p>一个分类可以有多门课程，一门课程也可以属于多个分类，所以他们是多对多的关系。多对多的关系，一般会设计个中间来维护关系</p>
</li>
<li><p>一个讲师可以讲多门课程，一门课程只能有一个讲师，所以他们是一对多的关系。一对多的关系，可以把关系维护在“一那张表中</p>
</li>
<li><p>旧表加字段，使用单独的sql：alter table，这样，上生产的时候也是执行这个sql</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> `course` <span class="keyword">add</span> <span class="keyword">column</span> (`teacher_id` <span class="type">char</span>(<span class="number">8</span>) comment  <span class="string">&#x27;讲师|teacher.id&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>需要重新生成mybatis-generator。增加字段重新生成代码时，CourseMapper.java不会变化。</p>
</li>
<li><p>要求：mybatis自动生成的四个文件不允许修改，这样才能做到重复生成</p>
</li>
<li><p>但是courseDto要手动添加course.java中新增加的变量</p>
</li>
<li><p>在course.vue中修改代码</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//在data中增加</span><br><span class="line">teachers: [],//页面打开始就加载所有讲师</span><br><span class="line">//在mounted中增加</span><br><span class="line"> _this.allTeacher();</span><br><span class="line">//增加方法</span><br><span class="line">allTeacher() &#123;</span><br><span class="line">  let _this = this;</span><br><span class="line">  Loading.show();</span><br><span class="line">  _this.$ajax.post(process.env.VUE_APP_SERVER + &#x27;/business/admin/teacher/all&#x27;).then((respond) =&gt; &#123;</span><br><span class="line">    Loading.hide();</span><br><span class="line">    let resp = respond.data;</span><br><span class="line">    _this.teachers = resp.content;</span><br><span class="line"></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li>在后端增加all方法，加载所有讲师信息。参照CategoryController的all来修改TeacherController。同样service也一样。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 列表查询</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/all&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseDto <span class="title function_">all</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ResponseDto</span> <span class="variable">responseDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseDto</span>();</span><br><span class="line">    List&lt;TeacherDto&gt; teacherDtoList = teacherService.all();</span><br><span class="line">    responseDto.setContent(teacherDtoList);</span><br><span class="line">    <span class="keyword">return</span> responseDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在课程表单中增加讲师选择框，在course.vue</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">  &lt;label  class=&quot;col-sm-2 control-label&quot;&gt;讲师&lt;/label&gt;</span><br><span class="line">  &lt;div class=&quot;col-sm-10&quot;&gt;</span><br><span class="line">    &lt;select v-model=&quot;course.teacherId&quot; class=&quot;form-control&quot;  &gt;</span><br><span class="line">      &lt;option v-for=&quot;o in teachers&quot; v-bind:value=&quot;o.id&quot;&gt;&#123;&#123;o.name&#125;&#125;&lt;/option&gt;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>课程列表中显示讲师信息，课程名字字体自适应：</p>
<ul>
<li>v-for中，对循环的数组，可通过filter进行数据过滤</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-for=&quot;teacher in teachers.filter(t=&gt;&#123;return t.id===course.teacherId&#125;)&quot; class=&quot;profile-activity clearfix&quot;&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;img v-show=&quot;!teacher.image&quot; class=&quot;pull-left&quot; src=&quot;/ace/assets/images/avatars/avatar5.png&quot;&gt;</span><br><span class="line">    &lt;img v-show=&quot;teacher.image&quot; class=&quot;pull-left&quot; v-bind:src=&quot;teacher.image&quot;&gt;</span><br><span class="line">    &lt;a class=&quot;user&quot; href=&quot;#&quot;&gt; &#123;&#123;teacher.name&#125;&#125; &lt;/a&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &#123;&#123;teacher.position&#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>字体大小自适应，根据屏幕的分辩率显示不同大小的字体</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@media (max-width: 1199px) &#123;</span><br><span class="line">  .caption h3 &#123;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>前端开发小技巧：可以用浏览器的开发工具修改样式，调试好后，再把样式拷到代码里</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="http://example.com">John Doe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2022/02/15/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%202-2/">http://example.com/2022/02/15/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%202-2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE/">完整项目</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/02/20/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%203-1/"><img class="prev-cover" src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">完整项目之Spring Cloud + Vue 前后端分离3-1</div></div></a></div><div class="next-post pull-right"><a href="/2022/02/07/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%202-1/"><img class="next-cover" src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">完整项目之Spring Cloud + Vue 前后端分离2-1</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2022/02/07/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%202-1/" title="完整项目之Spring Cloud + Vue 前后端分离2-1"><img class="cover" src="/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-07</div><div class="title">完整项目之Spring Cloud + Vue 前后端分离2-1</div></div></a></div><div><a href="/2022/02/20/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%203-1/" title="完整项目之Spring Cloud + Vue 前后端分离3-1"><img class="cover" src="/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-20</div><div class="title">完整项目之Spring Cloud + Vue 前后端分离3-1</div></div></a></div><div><a href="/2022/02/25/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%203-2/" title="完整项目之Spring Cloud + Vue 前后端分离3-2"><img class="cover" src="/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">完整项目之Spring Cloud + Vue 前后端分离3-2</div></div></a></div><div><a href="/2022/03/07/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%204-1/" title="完整项目之Spring Cloud + Vue 前后端分离4-1"><img class="cover" src="/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-07</div><div class="title">完整项目之Spring Cloud + Vue 前后端分离4-1</div></div></a></div><div><a href="/2022/03/20/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%205/" title="完整项目之Spring Cloud + Vue 前后端分离5"><img class="cover" src="/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-20</div><div class="title">完整项目之Spring Cloud + Vue 前后端分离5</div></div></a></div><div><a href="/2022/03/15/%E5%AE%8C%E6%95%B4%E9%A1%B9%E7%9B%AE%E4%B9%8BSpring%20Cloud%20+%20Vue%20%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%204-2/" title="完整项目之Spring Cloud + Vue 前后端分离4-2"><img class="cover" src="/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-15</div><div class="title">完整项目之Spring Cloud + Vue 前后端分离4-2</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">John Doe</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">307</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC7%E7%AB%A0-%E6%A0%B8%E5%BF%83%E4%B8%9A%E5%8A%A1%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91"><span class="toc-number">1.</span> <span class="toc-text">第7章 核心业务功能开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E8%AF%BE%E7%A8%8B%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91-%E8%AF%BE%E7%A8%8B%E5%A4%A7%E7%AB%A0%E5%B0%8F%E8%8A%82%E5%85%B3%E8%81%94"><span class="toc-number">1.1.</span> <span class="toc-text">7-1 课程管理功能开发-课程大章小节关联</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E8%AF%BE%E7%A8%8B%E6%97%B6%E9%95%BF%E7%9A%84%E4%BF%9D%E5%AD%98%E5%92%8C%E6%98%BE%E7%A4%BA"><span class="toc-number">1.2.</span> <span class="toc-text">7-2 课程时长的保存和显示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%E7%9A%84%E5%BC%80%E5%8F%91"><span class="toc-number">1.3.</span> <span class="toc-text">7-3 分类管理功能的开发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-%E8%AF%BE%E7%A8%8B%E5%92%8C%E5%88%86%E7%B1%BB%E5%85%B3%E8%81%94%E4%BF%9D%E5%AD%98%E5%92%8C%E6%98%BE%E7%A4%BA"><span class="toc-number">1.4.</span> <span class="toc-text">7-4 课程和分类关联保存和显示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-5-%E8%AF%BE%E7%A8%8B%E5%86%85%E5%AE%B9%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91"><span class="toc-number">1.5.</span> <span class="toc-text">7-5 课程内容功能开发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-6-%E8%AF%BE%E7%A8%8B%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96"><span class="toc-number">1.6.</span> <span class="toc-text">7-6 课程代码优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-7-%E8%AE%B2%E5%B8%88%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91"><span class="toc-number">1.7.</span> <span class="toc-text">7-7 讲师管理功能开发</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/07/31/Redis%E4%B9%8B%E5%B0%8F%E8%BF%9B%E9%98%B6/" title="Redis之小进阶"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis之小进阶"/></a><div class="content"><a class="title" href="/2022/07/31/Redis%E4%B9%8B%E5%B0%8F%E8%BF%9B%E9%98%B6/" title="Redis之小进阶">Redis之小进阶</a><time datetime="2022-07-31T06:56:48.000Z" title="Created 2022-07-31 14:56:48">2022-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/31/Redis%E4%B9%8BJava/" title="Redis之Java"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis之Java"/></a><div class="content"><a class="title" href="/2022/07/31/Redis%E4%B9%8BJava/" title="Redis之Java">Redis之Java</a><time datetime="2022-07-31T06:47:34.000Z" title="Created 2022-07-31 14:47:34">2022-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/31/Redis%E4%B9%8B%E4%BA%8B%E5%8A%A1/" title="Redis之事务"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis之事务"/></a><div class="content"><a class="title" href="/2022/07/31/Redis%E4%B9%8B%E4%BA%8B%E5%8A%A1/" title="Redis之事务">Redis之事务</a><time datetime="2022-07-31T06:46:19.000Z" title="Created 2022-07-31 14:46:19">2022-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/31/Redis%E4%B9%8B%E4%B8%89%E7%A7%8D%E7%89%B9%E6%AE%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="Redis之三种特殊数据类型"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis之三种特殊数据类型"/></a><div class="content"><a class="title" href="/2022/07/31/Redis%E4%B9%8B%E4%B8%89%E7%A7%8D%E7%89%B9%E6%AE%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="Redis之三种特殊数据类型">Redis之三种特殊数据类型</a><time datetime="2022-07-31T06:40:15.000Z" title="Created 2022-07-31 14:40:15">2022-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/31/Redis%E4%B9%8B%E4%BA%94%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="Redis之五大数据类型"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis之五大数据类型"/></a><div class="content"><a class="title" href="/2022/07/31/Redis%E4%B9%8B%E4%BA%94%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="Redis之五大数据类型">Redis之五大数据类型</a><time datetime="2022-07-31T06:25:38.000Z" title="Created 2022-07-31 14:25:38">2022-07-31</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By John Doe</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>